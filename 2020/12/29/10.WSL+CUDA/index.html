<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Windows 下利用 WSL2 配置 CUDA 和 pyCUDA | Ron's Blog</title><meta name="keywords" content="配置,WSL,CUDA,Windows,Linux,pycuda"><meta name="author" content="Ron"><meta name="copyright" content="Ron"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="利用 WSL2 完成了 CUDA 和 pyCUDA 的搭建，成功解放生产力。">
<meta property="og:type" content="article">
<meta property="og:title" content="Windows 下利用 WSL2 配置 CUDA 和 pyCUDA">
<meta property="og:url" content="https://qriosa.github.io/2020/12/29/10.WSL+CUDA/index.html">
<meta property="og:site_name" content="Ron&#39;s Blog">
<meta property="og:description" content="利用 WSL2 完成了 CUDA 和 pyCUDA 的搭建，成功解放生产力。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/wsl-launch-upt-0625-rz.png">
<meta property="article:published_time" content="2020-12-29T10:11:12.000Z">
<meta property="article:modified_time" content="2024-07-03T06:57:31.020Z">
<meta property="article:author" content="Ron">
<meta property="article:tag" content="配置">
<meta property="article:tag" content="WSL">
<meta property="article:tag" content="CUDA">
<meta property="article:tag" content="Windows">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="pycuda">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/wsl-launch-upt-0625-rz.png"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://qriosa.github.io/2020/12/29/10.WSL+CUDA/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="preconnect" href="//zz.bdstatic.com"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.js" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"KUPKZYGXJZ","apiKey":"c694052eee4849f0ddc6a25bc8e40d6c","indexName":"blog","hits":{"per_page":6},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: true
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2024-07-03 14:57:31'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = '1'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}const fontSizeVal = saveToLocal.get('global-font-size')
if (fontSizeVal !== undefined) {
  document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
}})()</script><meta name="generator" content="Hexo 5.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">32</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">62</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/wsl-launch-upt-0625-rz.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Ron's Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Windows 下利用 WSL2 配置 CUDA 和 pyCUDA</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-12-29T10:11:12.000Z" title="发表于 2020-12-29 18:11:12">2020-12-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-07-03T06:57:31.020Z" title="更新于 2024-07-03 14:57:31">2024-07-03</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/">环境配置</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>14分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="0x01-写在前面"><a href="#0x01-写在前面" class="headerlink" title="0x01 写在前面"></a>0x01 写在前面</h1><p>现在很多项目都是基于 Linux 开发的，但是平常使用还是 Windows 香。（主要是我物理机是 Windows 我又不想装成 Linux</p>
<p>而有时候 Windows 真的非常不利于开发者，他的各自环境太难配置了，这时候是 Linux 香。</p>
<p>但是 <code>WSL</code> 才是真的香，启动快，共享空间，现在还能共享 GPU 了。。。。。</p>
<p>而我本次鉴于某些原因，失去了千辛万苦配置好 Windows 上能跑的 <code>pycuda</code> 的环境，重配又没有成功。好契机。</p>
<p>不说这么多，我先冲了。希望本教程能帮到你。</p>
<p><br></p>
<h1 id="0x02-确保-WSL2"><a href="#0x02-确保-WSL2" class="headerlink" title="0x02 确保 WSL2"></a>0x02 确保 WSL2</h1><p>在此之前，先确保已经有 <code>WSL/WSL2</code> ，若无，则可参考<a target="_blank" rel="noopener" href="https://lucxer.tk/2020/12/28/WSL2%E5%AE%89%E8%A3%85/">另一篇博文</a>。</p>
<h2 id="2-1-检查现有的WSL版本"><a href="#2-1-检查现有的WSL版本" class="headerlink" title="2.1 检查现有的WSL版本"></a>2.1 检查现有的WSL版本</h2><p>以管理员身份运行 <code>cmd</code> ，并输入下面的命令，检查准备安装 <code>CUDA</code> 的 <code>Linux</code>发行版本的 <code>WSL</code> 版本。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --list -v</span><br></pre></td></tr></table></figure>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229161044721.png" alt="检查WSL版本"></p>
<p>如上图，笔者的两个都是 <code>WSL1</code> ，居然都是 <code>VERSION = 1</code>。 </p>
<blockquote>
<p>幸好笔者在搭建的时候遇到两次没有放弃。重新查阅了别人的博客，这才检查了自己的 <code>WSL</code> 的版本，才发现居然都是版本1，尽管在搭建之前已经执行了命令 <code>wsl --set-default-version 2</code> 设置默认版本为 <code>WSL2</code> 。但是居然安装的还是1，或许是笔者没有在应用商店安装而是使用了，<code>lxrunoffline</code> 工具。（参阅上一篇博客）。导致后续验证 <code>CUDA</code> 是否安装成功时，一直报错运行的 <code>CUDA</code> 版本与显卡驱动不匹配，笔者就轻信了，认为是 <code>CUDA11</code> 的锅，删除了 <code>WSL</code> 重装了一次，从 <code>CUDA11</code> 降到了 <code>CUDA10.2</code> ，然而还是一样的错误。</p>
<p>不过幸好这里找到了是这个原因，在转化升级 <code>WSL</code> 到 <code>WSL2</code> 之后，这个问题就不存在了。安装就一瞬完成了。</p>
</blockquote>
<p><br></p>
<h2 id="2-2-升级现有的-WSL-到-WSL2"><a href="#2-2-升级现有的-WSL-到-WSL2" class="headerlink" title="2.2 升级现有的 WSL 到 WSL2"></a>2.2 升级现有的 WSL 到 WSL2</h2><p>首先使用下面的命令，查看查看有哪些 <code>WSL</code> 。在 <code>cmd</code> 中键入下面的命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl -l</span><br></pre></td></tr></table></figure>
<p>然后将想要升级的名字记住，设置其版本为 <code>WSL2</code> ，在 <code>cmd</code> 中键入下面的命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># wsl --set-version &lt;WSL名称&gt; 2 </span><br><span class="line">wsl --set-version Ubuntu18CUDA 2</span><br></pre></td></tr></table></figure>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229161431055.png" alt="升级WSL"></p>
<p>这个过程取决于设备，可能时间比较久（笔者花了7分钟左右。）</p>
<p>待其完成后，就好啦。</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://raw.githubusercontent.com/qriosa/picgo-blog/master/img/image-20201229163244987.png" alt="转换完毕"></p>
<p>再查看，转换的版本就对了</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229163309999.png" alt="再次查看"></p>
<p><br></p>
<h1 id="0x03-安装-cuda"><a href="#0x03-安装-cuda" class="headerlink" title="0x03 安装 cuda"></a>0x03 安装 cuda</h1><h2 id="3-1-换源"><a href="#3-1-换源" class="headerlink" title="3.1 换源"></a>3.1 换源</h2><p>由于总所周知的原因，官方源往往很慢，于是推荐换个源先</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># 下面所有都是非 root 自己添加 sudo</span><br><span class="line"># 首先备份源列表</span><br><span class="line">cp &#x2F;etc&#x2F;apt&#x2F;sources.list &#x2F;etc&#x2F;apt&#x2F;sources.list_backup </span><br><span class="line"></span><br><span class="line"># 打开sources.list文件</span><br><span class="line">vim &#x2F;etc&#x2F;apt&#x2F;sources.list</span><br><span class="line"></span><br><span class="line"># 在最前面添加阿里源</span><br><span class="line">deb https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu&#x2F; bionic main restricted universe multiverse</span><br><span class="line">deb https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu&#x2F; bionic-security main restricted universe multiverse</span><br><span class="line">deb https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu&#x2F; bionic-updates main restricted universe multiverse</span><br><span class="line">deb https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu&#x2F; bionic-proposed main restricted universe multiverse</span><br><span class="line">deb https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu&#x2F; bionic-backports main restricted universe multiverse</span><br><span class="line">deb-src https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu&#x2F; bionic main restricted universe multiverse</span><br><span class="line">deb-src https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu&#x2F; bionic-security main restricted universe multiverse</span><br><span class="line">deb-src https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu&#x2F; bionic-updates main restricted universe multiverse</span><br><span class="line">deb-src https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu&#x2F; bionic-proposed main restricted universe multiverse</span><br><span class="line">deb-src https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu&#x2F; bionic-backports main restricted universe multiverse</span><br></pre></td></tr></table></figure>
<p>最好注释掉其他的，默认的，后面的源，不然会多一些不可达的不必要的error。</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229143627984.png" alt="换源"></p>
<p>然后刷新一下源，一定要刷新一下源。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt-get update</span><br><span class="line">apt-get upgrade</span><br><span class="line">apt-get install build-essential</span><br></pre></td></tr></table></figure>
<p>耗时有点久。。。。。</p>
<p><br></p>
<h2 id="3-2-安装驱动"><a href="#3-2-安装驱动" class="headerlink" title="3.2 安装驱动"></a>3.2 安装驱动</h2><p>这一部分的官方教程在这里：<a target="_blank" rel="noopener" href="https://docs.nvidia.com/cuda/wsl-user-guide/index.html">cuda for wsl</a></p>
<p><strong>在 Windows 上进行显卡驱动的安装。</strong></p>
<p>下载对应的显卡型号的驱动：<a target="_blank" rel="noopener" href="https://developer.nvidia.com/cuda/wsl/download">地址</a>。</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201228232321036.png" alt="下载驱动"></p>
<p>需要先注册一下 然后才能进行下载。</p>
<p>然后双击运行。默认目录就好。</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201228233000120.png" alt="安装驱动-1"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201228233547776.png" alt="安装驱动-2"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201228233634638.png" alt="安装驱动-3"></p>
<p><img src= "/img/loading.gif" data-lazy-src="C:\Users\chegn\AppData\Roaming\Typora\typora-user-images\image-20201228233640692.png" alt="安装驱动-4"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201228233649063.png" alt="安装驱动-5"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201228234149312.png" alt="安装驱动-6"></p>
<p><br></p>
<h2 id="3-3-安装-cuda-toolkit"><a href="#3-3-安装-cuda-toolkit" class="headerlink" title="3.3. 安装 cuda toolkit"></a>3.3. 安装 cuda toolkit</h2><h3 id="3-3-1-安装"><a href="#3-3-1-安装" class="headerlink" title="3.3.1 安装"></a>3.3.1 安装</h3><p>输入以下命令进行，以安装 cuda toolkit。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">apt-key adv --fetch-keys http://developer.download.nvidia.com/compute/cuda/repos/ubuntu1804/x86_64/7fa2af80.pub</span><br><span class="line"></span><br><span class="line">sh -c <span class="string">&#x27;echo &quot;deb http://developer.download.nvidia.com/compute/cuda/repos/ubuntu1804/x86_64 /&quot; &gt; /etc/apt/sources.list.d/cuda.list&#x27;</span></span><br><span class="line"></span><br><span class="line">apt-get update</span><br></pre></td></tr></table></figure>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229134330940.png" alt="命令截图1"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229135542045.png" alt="命令截图2"></p>
<p><br></p>
<p>然后是 install CUDA，笔者这里是选择的 10.2 版本。</p>
<blockquote>
<p>CUDA Device Query (Runtime API) version (CUDART static linking)  cudaGetDeviceCount returned 35 -&gt; CUDA driver version is insufficient for CUDA runtime version Result = FAIL</p>
</blockquote>
<p>援引官方的话，读者也可以自己选择自己想要的版本。</p>
<blockquote>
<p>Do not choose the cuda, cuda-11-0, or cuda-drivers meta-packages under WSL 2 since these packages will result in an attempt to install the Linux NVIDIA driver under WSL 2.</p>
<p>意思是，不要在命令中直接选择 <code>cuda</code> 、 <code>cuda-11-0</code> 这种名字，在 WSL 中，必须要用 <code>cuda-toolkit-10-2</code> 这种格式的名字。</p>
</blockquote>
<p><strong>下面命令2选1。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 笔者安装 10.2</span><br><span class="line">apt-get install -y cuda-toolkit-10-2</span><br><span class="line"></span><br><span class="line"># 官方叫安装 11</span><br><span class="line">apt-get install -y cuda-toolkit-11-0</span><br></pre></td></tr></table></figure>
<blockquote>
<p>这里还错怪了一波 11 版本，读者大可以选择 11。</p>
</blockquote>
<p>时间有点久  请耐心等待，要是没换源估计更慢了，现在切回去换源还来得及。</p>
<h3 id="3-3-2-debug"><a href="#3-3-2-debug" class="headerlink" title="3.3.2 debug"></a>3.3.2 debug</h3><p>完事之后，你有可能可能会看到这个 <code>error</code>。</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229141223257.png" alt="error-1"></p>
<p><code>apt-get</code> 已经用过了，那就加上 <code>--fix-missing</code> 吧。但是笔者这边实测只是跳过了， <code>error</code> 并没解决。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install -y cuda-toolkit-10-2 --fix-missing</span><br></pre></td></tr></table></figure>
<p>然后发现，<strong>这个多半是源更换了，没有刷新的缘故</strong>。回到换源的地方，刷新一下源再执行下面的命令就可以了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install -y cuda-toolkit-10-2</span><br></pre></td></tr></table></figure>
<h3 id="3-3-3-安装完成"><a href="#3-3-3-安装完成" class="headerlink" title="3.3.3 安装完成"></a>3.3.3 安装完成</h3><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229150828428.png" alt="安装完成"></p>
<p>按照<a target="_blank" rel="noopener" href="https://docs.nvidia.com/cuda/wsl-user-guide/index.html#unique_2118253331">官方的说法</a>似乎就可以了？</p>
<blockquote>
<p>Running CUDA Applications<br>Just run your CUDA app as you would run it under Linux! Once the driver is installed there is nothing more to do to run existing CUDA applications that were built on Linux.</p>
<p>A snippet of running the BlackScholes Linux application from the CUDA samples is shown below.</p>
<p>Build the CUDA samples available under /usr/local/cuda/samples from your installation of the CUDA Toolkit in the previous section. The BlackScholes application is located under /usr/local/cuda/samples/4_Finance/BlackScholes. Alternatively, you can transfer a binary built on Linux to WSL 2!</p>
</blockquote>
<p><br></p>
<h2 id="3-4-检查安装"><a href="#3-4-检查安装" class="headerlink" title="3.4 检查安装"></a>3.4 检查安装</h2><p>在 <code>/usr/local</code> 下可以看到刚刚的安装。而且 <code>CUDA</code> 的版本是 <code>10.2</code> ，所以 <code>cuDNN</code> 也下载 <code>CUDA10.2</code> 对应的版本。</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229151149679.png" alt="查看cuda"></p>
<p>然后我们依然安装 cudnn，<a target="_blank" rel="noopener" href="https://docs.nvidia.com/deeplearning/sdk/cudnn-install/index.html#install-linux">官方教程</a>。 </p>
<h3 id="3-4-1-Windows-查看-WSL-的文件"><a href="#3-4-1-Windows-查看-WSL-的文件" class="headerlink" title="3.4.1 Windows 查看 WSL 的文件"></a>3.4.1 Windows 查看 WSL 的文件</h3><p>由于 <code>WSL</code> 和 Windows 的文件系统是通用的，因此，我们可以通过 Windows 下载了拷贝进去。</p>
<blockquote>
<p>Windows 直接在文件夹左侧就能看到对应的 Ubuntu WSL</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229175715371.png" alt="查看WSL"></p>
<h3 id="3-4-2-WSL-查看-Windows-文件"><a href="#3-4-2-WSL-查看-Windows-文件" class="headerlink" title="3.4.2 WSL 查看 Windows 文件"></a>3.4.2 WSL 查看 Windows 文件</h3><blockquote>
<p><code>WSL</code> 看 Windows 的子系统则可以在文件系统中的 <code>/mnt</code> 下面。c、d、e就是对应的盘。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229151541069.png" alt="查看Windows的系统盘"></p>
<p><br></p>
<h1 id="0x04-安装-cuDNN"><a href="#0x04-安装-cuDNN" class="headerlink" title="0x04 安装 cuDNN"></a>0x04 安装 cuDNN</h1><h2 id="4-1-下载-cuDNN"><a href="#4-1-下载-cuDNN" class="headerlink" title="4.1 下载 cuDNN"></a>4.1 下载 cuDNN</h2><p>下载 cuDNN：<a target="_blank" rel="noopener" href="https://developer.nvidia.com/cudnn">地址</a>。</p>
<p>选择 Linux 的对应版本的 tar.gz，笔者这里是 10.2 。</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229151328570.png" alt="下载对应的cuDNN"></p>
<p><br></p>
<h2 id="4-2-移动文件"><a href="#4-2-移动文件" class="headerlink" title="4.2 移动文件"></a>4.2 移动文件</h2><p>下载完毕后，就是通过文件的本质共享，将其移动到子系统的某个位置去。</p>
<p>笔者下载下来是这个名字 <code>cudnn-10.2-linux-x64-v8.0.5.39.solitairetheme8</code> 笔者重命名了 <code>cudnn-10.2-linux-x64-v8.0.5.39.tar.gz</code></p>
<p>然后运行下面的命令进行拷贝和解压。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 新建目录</span></span><br><span class="line">mkdir /usr/local/temp</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 拷贝文件</span></span><br><span class="line">cp cudnn-10.2-linux-x64-v8.0.5.39.tar.gz /usr/local/temp</span><br></pre></td></tr></table></figure>
<p>然后在temp文件夹对其进行解压，注意更换对应的文件名哈。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xzvf cudnn-10.2-linux-x64-v8.0.5.39.tar.gz</span><br></pre></td></tr></table></figure>
<p>解压完毕后。</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229152202456.png" alt="解压完毕"></p>
<p><br></p>
<h2 id="4-3-移动到-CUDA-目录"><a href="#4-3-移动到-CUDA-目录" class="headerlink" title="4.3 移动到 CUDA 目录"></a>4.3 移动到 CUDA 目录</h2><p>执行下面的三个命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cp cuda/include/cudnn*.h /usr/local/cuda/include</span><br><span class="line">cp cuda/lib64/libcudnn* /usr/local/cuda/lib64</span><br><span class="line">chmod a+r /usr/local/cuda/include/cudnn*.h /usr/local/cuda/lib64/libcudnn*</span><br></pre></td></tr></table></figure>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229152357564.png" alt="拷贝cuDNN"></p>
<p>由于文件有点多，第二个复制耗时有点长。然后 <code>temp</code> 文件夹也可以删除了。</p>
<p>于是就安装完成了。</p>
<p><br></p>
<h1 id="0x05-测试安装"><a href="#0x05-测试安装" class="headerlink" title="0x05 测试安装"></a>0x05 测试安装</h1><h2 id="5-1-设置环境变量"><a href="#5-1-设置环境变量" class="headerlink" title="5.1 设置环境变量"></a>5.1 设置环境变量</h2><p>设置一个环境变量，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export CUDA_HOME&#x3D;&#x2F;usr&#x2F;local&#x2F;cuda</span><br><span class="line">export PATH&#x3D;$PATH:$CUDA_HOME&#x2F;bin</span><br><span class="line">export LD_LIBRARY_PATH&#x3D;&#x2F;usr&#x2F;local&#x2F;cuda-10.2&#x2F;lib64$&#123;LD_LIBRARY_PATH:+:$&#123;LD_LIBRARY_PATH&#125;&#125; # 前两个必须要修改什么，第三个则需要根据版本的不同，修改路径中的10.2</span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="5-2-编译-demo"><a href="#5-2-编译-demo" class="headerlink" title="5.2 编译 demo"></a>5.2 编译 demo</h2><p>移步到 demo 中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;usr&#x2F;local&#x2F;cuda&#x2F;samples&#x2F;1_Utilities&#x2F;deviceQuery </span><br></pre></td></tr></table></figure>
<p>有 <code>makefile</code> ，我们直接 <code>make</code> 编译一下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make</span><br></pre></td></tr></table></figure>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229152927912.png" alt="编译测试文件"></p>
<p><br></p>
<h2 id="5-3-运行-demo"><a href="#5-3-运行-demo" class="headerlink" title="5.3 运行 demo"></a>5.3 运行 demo</h2><p>然后运行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;deviceQuery</span><br></pre></td></tr></table></figure>
<p>正常情况下，会看到下面的样子。</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229163716541.png" alt="deviceQuery-1"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229163733405.png" alt="deviceQuery-2"></p>
<p><br></p>
<h2 id="5-4-debug"><a href="#5-4-debug" class="headerlink" title="5.4 debug"></a>5.4 debug</h2><p>有可能会遇到下面的错误，错版本和驱动不兼容。。。。</p>
<blockquote>
<p>CUDA Device Query (Runtime API) version (CUDART static linking)  cudaGetDeviceCount returned 35 -&gt; CUDA driver version is insufficient for CUDA runtime version Result = FAIL</p>
</blockquote>
<p>但是在解决了 <code>WSL</code> 到 <code>WSL2</code> 的问题后就一瞬成功了。可能就是因为笔者使用的工具，所以默认的 <code>WSL2</code> 的选项没有生效，于是安装的都是 <code>WSL1</code> 的发行版，于是一直不成功。升级到 <code>WSL2</code> 后，再运行就一瞬成功了。</p>
<p><strong>如果读者也遇到了此问题，不妨返回开头检查自己是否是 <code>WSL2</code> 。</strong></p>
<p><br></p>
<h1 id="0x06-安装-conda"><a href="#0x06-安装-conda" class="headerlink" title="0x06 安装 conda"></a>0x06 安装 conda</h1><h2 id="6-1-安装-conda"><a href="#6-1-安装-conda" class="headerlink" title="6.1 安装 conda"></a>6.1 安装 conda</h2><p>安装一个 mini conda。</p>
<p>首先下载文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https:&#x2F;&#x2F;repo.anaconda.com&#x2F;miniconda&#x2F;Miniconda3-latest-Linux-x86_64.sh </span><br></pre></td></tr></table></figure>
<p>然后运行进行安装，按照提示输入两个 <code>yes</code> 安装就好，主要是第二个，是否需要自动运行 <code>conda init</code> 如果选择默认的 <code>no</code> 则需要自己设定环境变量，否则系统不认识 <code>conda</code> 因此，推荐输入 <code>yes</code> 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash Miniconda3-latest-Linux-x86_64.sh </span><br></pre></td></tr></table></figure>
<p><strong>安装完毕后需要将此终端关闭，然后新开一个进入才会生效。</strong></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20210104185031677.png" alt="安装 conda"></p>
<p><br></p>
<h2 id="6-2-新建虚拟环境"><a href="#6-2-新建虚拟环境" class="headerlink" title="6.2 新建虚拟环境"></a>6.2 新建虚拟环境</h2><blockquote>
<p>虚拟环境有诸多好处，以下是笔者觉得的好处：</p>
<p>1、各个项目的需求和依赖有所不同，不同的项目可能对环境有冲突，虚拟环境就可以各自独立，互不影响。</p>
<p>2、各个项目独立，使得各自的项目环境独立，在到处依赖的时候不会导出更多的无关的依赖。</p>
<p>3、万一搞废了，重新整一个也不至于全部都废弃了。</p>
<p>等等。</p>
</blockquote>
<p>创建一个虚拟环境，这里我们选择 3.6。（就是随便选了一个，貌似 Linux 默认的 python 就是3.6</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda create --name py36CUDA python&#x3D;3.6</span><br></pre></td></tr></table></figure>
<p>建立完毕后，我们如何使用，这里也说的很清楚了。</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229012149782.png" alt="使用虚拟环境"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 进入虚拟环境</span><br><span class="line">conda activate py36CUDA # 虚拟环境的名字</span><br><span class="line"></span><br><span class="line"># 退出虚拟环境</span><br><span class="line">conda deactivate</span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="6-3-conda-换源"><a href="#6-3-conda-换源" class="headerlink" title="6.3 conda 换源"></a>6.3 conda 换源</h2><p>和前面一样的原因，我们还是换个源。输入下面的命令打开文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~&#x2F;.condarc</span><br></pre></td></tr></table></figure>
<p>输入下面的内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">channels:</span><br><span class="line">  - https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;anaconda&#x2F;pkgs&#x2F;main&#x2F;</span><br><span class="line">  - https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;anaconda&#x2F;pkgs&#x2F;free&#x2F;</span><br><span class="line">  - https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;anaconda&#x2F;cloud&#x2F;conda-forge&#x2F;</span><br><span class="line">  - https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;anaconda&#x2F;cloud&#x2F;pytorch&#x2F;</span><br><span class="line">ssl_verify: true</span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="6-4-安装-pyCUDA"><a href="#6-4-安装-pyCUDA" class="headerlink" title="6.4 安装 pyCUDA"></a>6.4 安装 pyCUDA</h2><h3 id="6-4-1-尝试安装"><a href="#6-4-1-尝试安装" class="headerlink" title="6.4.1 尝试安装"></a>6.4.1 尝试安装</h3><p>然后我们安装 <code>pycuda</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install pycuda</span><br></pre></td></tr></table></figure>
<p>然后还是报错了。。。。。报错信息是 <code>g++</code> 怎么怎么，这里不想列举了，太多了。</p>
<h3 id="6-4-2-apt-安装"><a href="#6-4-2-apt-安装" class="headerlink" title="6.4.2 apt 安装"></a>6.4.2 apt 安装</h3><p>在上述失败后，查阅到另一种方法，试试吧。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install python3-pycuda</span><br></pre></td></tr></table></figure>
<p>装了好多好大的文件。提示成功了。</p>
<p>但是在终端中（非虚拟环境） 输入 python3 还是无法 <code>import pycuda</code></p>
<p>虚拟环境中也是一样。</p>
<h3 id="6-4-3-返璞归真"><a href="#6-4-3-返璞归真" class="headerlink" title="6.4.3 返璞归真"></a>6.4.3 返璞归真</h3><p>然后又在虚拟环境中，尝试安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install pycuda</span><br></pre></td></tr></table></figure>
<p>这次没有报错，但是直接报错找不到这个 <code>pycuda</code>。</p>
<p>查阅了资料，或许是应该笔者安装的 <code>CUDA10.2</code> 所以最新的 <code>pycuda2020</code> 不兼容。</p>
<p>于是，更换了安装命令，就安装成功了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install pycuda&#x3D;&#x3D;2019.1.2</span><br></pre></td></tr></table></figure>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229174146584.png" alt="安装 pycuda2019"></p>
<p><br></p>
<h2 id="6-5-测试-pycuda"><a href="#6-5-测试-pycuda" class="headerlink" title="6.5 测试 pycuda"></a>6.5 测试 pycuda</h2><h3 id="6-5-1-导入-autoinit-测试"><a href="#6-5-1-导入-autoinit-测试" class="headerlink" title="6.5.1 导入 autoinit 测试"></a>6.5.1 导入 autoinit 测试</h3><p>然后我们进入虚拟环境中进行 python 测试一波。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># conda activate py36CUDA </span><br><span class="line"># python</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; from pycuda import autoinit</span><br></pre></td></tr></table></figure>
<p>但是报错无 <code>six</code>。</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229174307861.png" alt="test-pycuda1"></p>
<p>那就装一个 <code>six</code> 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install six</span><br></pre></td></tr></table></figure>
<p>完事之后就成了。</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229174430625.png" alt="image-20201229174430625"></p>
<p><strong>初战告捷，准备开冲。</strong></p>
<h3 id="6-5-2-实战测试"><a href="#6-5-2-实战测试" class="headerlink" title="6.5.2 实战测试"></a>6.5.2 实战测试</h3><p>新建一个 a+b copy 进去，计算加法。</p>
<h4 id="6-5-2-1-建立源码"><a href="#6-5-2-1-建立源码" class="headerlink" title="6.5.2.1 建立源码"></a>6.5.2.1 建立源码</h4><p>建立 <code>a+b.py</code> 。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pycuda.autoinit</span><br><span class="line"><span class="keyword">import</span> pycuda.driver <span class="keyword">as</span> drv</span><br><span class="line"><span class="keyword">from</span> pycuda.compiler <span class="keyword">import</span> SourceModule</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;a+b.cu&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding = <span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	cuf = f.read()</span><br><span class="line">mod = SourceModule(cuf)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取kernal函数</span></span><br><span class="line">add_func = mod.get_function(<span class="string">&#x27;add&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入 numpy</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化 a, b, c</span></span><br><span class="line">a = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>], dtype = np.int32)</span><br><span class="line">b = np.array([<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">32</span>], dtype = np.int32)</span><br><span class="line">c = np.full((<span class="number">10</span>, ), <span class="number">0</span>).astype(np.int32)</span><br><span class="line">n = np.int32(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = a+b</span></span><br><span class="line">add_func(drv.In(a), drv.In(b), drv.InOut(c), drv.In(n), block=(<span class="number">32</span>,<span class="number">1</span>,<span class="number">1</span>), grid=(<span class="number">1</span>,<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># print</span></span><br><span class="line">print(c)</span><br></pre></td></tr></table></figure>
<p>建立 <code>a+b.cu</code> </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> *a, <span class="keyword">int</span> *b, <span class="keyword">int</span> *c, <span class="keyword">int</span> *n)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> tid = threadIdx.x;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(tid &lt; (*n))&#123;</span><br><span class="line">        c[tid] = a[tid] + b[tid];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="6-5-2-2-copy-到-WSL-中"><a href="#6-5-2-2-copy-到-WSL-中" class="headerlink" title="6.5.2.2 copy 到 WSL 中"></a>6.5.2.2 copy 到 WSL 中</h4><p>笔者这里建立了一个 <code>test</code> 目录。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp a+b.* &#x2F;home&#x2F;test&#x2F;</span><br></pre></td></tr></table></figure>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229174644503.png" alt="copy文件"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229174712792.png" alt="查看copy"></p>
<h4 id="6-5-2-3-运行"><a href="#6-5-2-3-运行" class="headerlink" title="6.5.2.3 运行"></a>6.5.2.3 运行</h4><p>完事之后，直接开冲。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 a+b.py </span><br></pre></td></tr></table></figure>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/image-20201229174742269.png" alt="运行结果"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>], dtype = np.int32)</span><br><span class="line">b = np.array([<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">32</span>], dtype = np.int32)</span><br><span class="line"></span><br><span class="line">(c = a + b)</span><br><span class="line">c == [ <span class="number">3</span>  <span class="number">5</span>  <span class="number">8</span> <span class="number">10</span> <span class="number">12</span>  <span class="number">7</span>  <span class="number">9</span> <span class="number">13</span> <span class="number">10</span> <span class="number">42</span>]</span><br></pre></td></tr></table></figure>
<p>显然是对了的。</p>
<p><br></p>
<h1 id="0x07-总结"><a href="#0x07-总结" class="headerlink" title="0x07 总结"></a>0x07 总结</h1><p>本次安装历时两天，因为某些必要的原因恢复了物理机的系统，导致机器的环境都无了。</p>
<p>当再次在 Windows 物理机上配置 <code>pycuda</code> 的环境时，按照以前的教程，花费了一天却一直没有成功，查查查就放弃了。</p>
<p>偶然发现了 <code>WSL</code> 还有了 2，并且还支持 <code>CUDA</code> 了，那这必然也能支持 <code>pycuda</code> 了。于是我又花了另外一天来搭建这个环境。</p>
<blockquote>
<p>对了，还有5天就期末考试的第一门了，我还没复习。GG。</p>
</blockquote>
<p><br></p>
<h1 id="0x08-参考"><a href="#0x08-参考" class="headerlink" title="0x08 参考"></a>0x08 参考</h1><p>wsl + cuda: <a target="_blank" rel="noopener" href="https://blog.csdn.net/Raink_LH/article/details/107220941">https://blog.csdn.net/Raink_LH/article/details/107220941</a></p>
<p>wsl+cuda 官方教程: <a target="_blank" rel="noopener" href="https://docs.nvidia.com/cuda/wsl-user-guide/index.html#installing-nvidia-drivers">https://docs.nvidia.com/cuda/wsl-user-guide/index.html#installing-nvidia-drivers</a></p>
<p>wsl+cuda+（anaconde）python 官方教程:  <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/win32/direct3d12/gpu-tensorflow-wsl">https://docs.microsoft.com/en-us/windows/win32/direct3d12/gpu-tensorflow-wsl</a></p>
<p>cuda demo测试:  <a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000022422496">https://segmentfault.com/a/1190000022422496</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Ron</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://qriosa.github.io/2020/12/29/10.WSL+CUDA/">https://qriosa.github.io/2020/12/29/10.WSL+CUDA/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://qriosa.github.io" target="_blank">Ron's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E9%85%8D%E7%BD%AE/">配置</a><a class="post-meta__tags" href="/tags/WSL/">WSL</a><a class="post-meta__tags" href="/tags/CUDA/">CUDA</a><a class="post-meta__tags" href="/tags/Windows/">Windows</a><a class="post-meta__tags" href="/tags/Linux/">Linux</a><a class="post-meta__tags" href="/tags/pycuda/">pycuda</a></div><div class="post_share"><div class="addthis_inline_share_toolbox"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=5fb3e45d5f9ff11c" async="async"></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.png" target="_blank"><img class="post-qr-code-img" data-lazy-src="/img/wechat.png" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.png" target="_blank"><img class="post-qr-code-img" data-lazy-src="/img/alipay.png" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/01/04/11.%E7%BC%96%E5%86%99%E7%88%AC%E8%99%AB/"><img class="prev-cover" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/crawl.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Scrapy + requests 快速构建自己的爬虫</div></div></a></div><div class="next-post pull-right"><a href="/2020/12/28/9.WSL2%E5%AE%89%E8%A3%85/"><img class="next-cover" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/Install_WSL_on_Win10.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Windows 使用 lxrunoffline 安装 WSL、WSL2</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2020/12/28/9.WSL2安装/" title="Windows 使用 lxrunoffline 安装 WSL、WSL2"><img class="cover" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/Install_WSL_on_Win10.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-28</div><div class="title">Windows 使用 lxrunoffline 安装 WSL、WSL2</div></div></a></div><div><a href="/2020/09/15/4.latex配置/" title="Windows 下 latex 配置"><img class="cover" data-lazy-src="https://www.latex-project.org/img/latex-project-logo.svg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-15</div><div class="title">Windows 下 latex 配置</div></div></a></div><div><a href="/2020/08/09/1.hexo-github-zeit搭建博客/" title="hexo+github+zeit搭建博客"><img class="cover" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/landscape.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-09</div><div class="title">hexo+github+zeit搭建博客</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" data-lazy-src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Ron</div><div class="author-info__description">retired OIer, Novice CTF Enthusiast</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">32</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">62</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/LCX666"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/qriosa" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:chegnxiang@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">号外！号外！号外！评论系统已开放！</div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01-%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2"><span class="toc-number">1.</span> <span class="toc-text">0x01 写在前面</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x02-%E7%A1%AE%E4%BF%9D-WSL2"><span class="toc-number">2.</span> <span class="toc-text">0x02 确保 WSL2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E6%A3%80%E6%9F%A5%E7%8E%B0%E6%9C%89%E7%9A%84WSL%E7%89%88%E6%9C%AC"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 检查现有的WSL版本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-%E5%8D%87%E7%BA%A7%E7%8E%B0%E6%9C%89%E7%9A%84-WSL-%E5%88%B0-WSL2"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 升级现有的 WSL 到 WSL2</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x03-%E5%AE%89%E8%A3%85-cuda"><span class="toc-number">3.</span> <span class="toc-text">0x03 安装 cuda</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-%E6%8D%A2%E6%BA%90"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 换源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-%E5%AE%89%E8%A3%85%E9%A9%B1%E5%8A%A8"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 安装驱动</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-%E5%AE%89%E8%A3%85-cuda-toolkit"><span class="toc-number">3.3.</span> <span class="toc-text">3.3. 安装 cuda toolkit</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-1-%E5%AE%89%E8%A3%85"><span class="toc-number">3.3.1.</span> <span class="toc-text">3.3.1 安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-2-debug"><span class="toc-number">3.3.2.</span> <span class="toc-text">3.3.2 debug</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-3-%E5%AE%89%E8%A3%85%E5%AE%8C%E6%88%90"><span class="toc-number">3.3.3.</span> <span class="toc-text">3.3.3 安装完成</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4-%E6%A3%80%E6%9F%A5%E5%AE%89%E8%A3%85"><span class="toc-number">3.4.</span> <span class="toc-text">3.4 检查安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-1-Windows-%E6%9F%A5%E7%9C%8B-WSL-%E7%9A%84%E6%96%87%E4%BB%B6"><span class="toc-number">3.4.1.</span> <span class="toc-text">3.4.1 Windows 查看 WSL 的文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-2-WSL-%E6%9F%A5%E7%9C%8B-Windows-%E6%96%87%E4%BB%B6"><span class="toc-number">3.4.2.</span> <span class="toc-text">3.4.2 WSL 查看 Windows 文件</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x04-%E5%AE%89%E8%A3%85-cuDNN"><span class="toc-number">4.</span> <span class="toc-text">0x04 安装 cuDNN</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-%E4%B8%8B%E8%BD%BD-cuDNN"><span class="toc-number">4.1.</span> <span class="toc-text">4.1 下载 cuDNN</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-%E7%A7%BB%E5%8A%A8%E6%96%87%E4%BB%B6"><span class="toc-number">4.2.</span> <span class="toc-text">4.2 移动文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-%E7%A7%BB%E5%8A%A8%E5%88%B0-CUDA-%E7%9B%AE%E5%BD%95"><span class="toc-number">4.3.</span> <span class="toc-text">4.3 移动到 CUDA 目录</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x05-%E6%B5%8B%E8%AF%95%E5%AE%89%E8%A3%85"><span class="toc-number">5.</span> <span class="toc-text">0x05 测试安装</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-%E8%AE%BE%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-number">5.1.</span> <span class="toc-text">5.1 设置环境变量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-%E7%BC%96%E8%AF%91-demo"><span class="toc-number">5.2.</span> <span class="toc-text">5.2 编译 demo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-%E8%BF%90%E8%A1%8C-demo"><span class="toc-number">5.3.</span> <span class="toc-text">5.3 运行 demo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4-debug"><span class="toc-number">5.4.</span> <span class="toc-text">5.4 debug</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x06-%E5%AE%89%E8%A3%85-conda"><span class="toc-number">6.</span> <span class="toc-text">0x06 安装 conda</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-%E5%AE%89%E8%A3%85-conda"><span class="toc-number">6.1.</span> <span class="toc-text">6.1 安装 conda</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-%E6%96%B0%E5%BB%BA%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83"><span class="toc-number">6.2.</span> <span class="toc-text">6.2 新建虚拟环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3-conda-%E6%8D%A2%E6%BA%90"><span class="toc-number">6.3.</span> <span class="toc-text">6.3 conda 换源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-4-%E5%AE%89%E8%A3%85-pyCUDA"><span class="toc-number">6.4.</span> <span class="toc-text">6.4 安装 pyCUDA</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-1-%E5%B0%9D%E8%AF%95%E5%AE%89%E8%A3%85"><span class="toc-number">6.4.1.</span> <span class="toc-text">6.4.1 尝试安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-2-apt-%E5%AE%89%E8%A3%85"><span class="toc-number">6.4.2.</span> <span class="toc-text">6.4.2 apt 安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-3-%E8%BF%94%E7%92%9E%E5%BD%92%E7%9C%9F"><span class="toc-number">6.4.3.</span> <span class="toc-text">6.4.3 返璞归真</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-5-%E6%B5%8B%E8%AF%95-pycuda"><span class="toc-number">6.5.</span> <span class="toc-text">6.5 测试 pycuda</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-1-%E5%AF%BC%E5%85%A5-autoinit-%E6%B5%8B%E8%AF%95"><span class="toc-number">6.5.1.</span> <span class="toc-text">6.5.1 导入 autoinit 测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-2-%E5%AE%9E%E6%88%98%E6%B5%8B%E8%AF%95"><span class="toc-number">6.5.2.</span> <span class="toc-text">6.5.2 实战测试</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-2-1-%E5%BB%BA%E7%AB%8B%E6%BA%90%E7%A0%81"><span class="toc-number">6.5.2.1.</span> <span class="toc-text">6.5.2.1 建立源码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-2-2-copy-%E5%88%B0-WSL-%E4%B8%AD"><span class="toc-number">6.5.2.2.</span> <span class="toc-text">6.5.2.2 copy 到 WSL 中</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-2-3-%E8%BF%90%E8%A1%8C"><span class="toc-number">6.5.2.3.</span> <span class="toc-text">6.5.2.3 运行</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x07-%E6%80%BB%E7%BB%93"><span class="toc-number">7.</span> <span class="toc-text">0x07 总结</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x08-%E5%8F%82%E8%80%83"><span class="toc-number">8.</span> <span class="toc-text">0x08 参考</span></a></li></ol></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/12/23/32.LLVM%E5%8F%8Aclang%E5%85%A5%E9%97%A8/" title="LLVM及clang入门"><img data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/llvm_logo.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="LLVM及clang入门"/></a><div class="content"><a class="title" href="/2022/12/23/32.LLVM%E5%8F%8Aclang%E5%85%A5%E9%97%A8/" title="LLVM及clang入门">LLVM及clang入门</a><time datetime="2022-12-23T13:12:49.000Z" title="发表于 2022-12-23 21:12:49">2022-12-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/10/05/31.%E4%B8%A4%E4%B8%AA%E5%AF%86%E7%A0%81%E9%A2%98/" title="两个有意思的题"><img data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/practice_3_crypto.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="两个有意思的题"/></a><div class="content"><a class="title" href="/2021/10/05/31.%E4%B8%A4%E4%B8%AA%E5%AF%86%E7%A0%81%E9%A2%98/" title="两个有意思的题">两个有意思的题</a><time datetime="2021-10-05T04:15:06.000Z" title="发表于 2021-10-05 12:15:06">2021-10-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/09/25/30.RSA-%E7%9B%B8%E5%85%B3%E6%B6%88%E6%81%AF%E6%94%BB%E5%87%BB/" title="RSA-9 Coppersmith 相关攻击"><img data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/RSA-9.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="RSA-9 Coppersmith 相关攻击"/></a><div class="content"><a class="title" href="/2021/09/25/30.RSA-%E7%9B%B8%E5%85%B3%E6%B6%88%E6%81%AF%E6%94%BB%E5%87%BB/" title="RSA-9 Coppersmith 相关攻击">RSA-9 Coppersmith 相关攻击</a><time datetime="2021-09-25T05:25:46.000Z" title="发表于 2021-09-25 13:25:46">2021-09-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/09/15/29.RSA-%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0(%E5%B9%BF%E6%92%AD)%E6%94%BB%E5%87%BB/" title="RSA-8 低加密指数广播攻击"><img data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/RSA-8.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="RSA-8 低加密指数广播攻击"/></a><div class="content"><a class="title" href="/2021/09/15/29.RSA-%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0(%E5%B9%BF%E6%92%AD)%E6%94%BB%E5%87%BB/" title="RSA-8 低加密指数广播攻击">RSA-8 低加密指数广播攻击</a><time datetime="2021-09-15T15:13:10.000Z" title="发表于 2021-09-15 23:13:10">2021-09-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/09/11/28.RSA-%E4%BD%8E%E8%A7%A3%E5%AF%86%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB/" title="RSA-7 低解密指数攻击"><img data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/RSA-7.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="RSA-7 低解密指数攻击"/></a><div class="content"><a class="title" href="/2021/09/11/28.RSA-%E4%BD%8E%E8%A7%A3%E5%AF%86%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB/" title="RSA-7 低解密指数攻击">RSA-7 低解密指数攻击</a><time datetime="2021-09-11T05:23:15.000Z" title="发表于 2021-09-11 13:23:15">2021-09-11</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Ron</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to <a href="https://qriosa.github.io">Ron's home</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.spacingElementById('content-inner')
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.spacingElementById('content-inner')
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/algolia.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> {preloader.endLoading()})</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    loader: {
      source: {
        '[tex]/amsCd': '[tex]/amscd'
      }
    },
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        addClass: [200,() => {
          document.querySelectorAll('mjx-container:not([display=\'true\']').forEach( node => {
            const target = node.parentNode
            if (!target.classList.contains('has-jax')) {
              target.classList.add('mathjax-overflow')
            }
          })
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>function loadValine () {
  function initValine () {
    let initData = {
      el: '#vcomment',
      appId: 'bXVyoSRa1rEnCAScfAPp2a6J-MdYXbMMI',
      appKey: 'MPmhrDo6YIbw4Ostjj3Dl18c',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'en',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
    }

    if (true) { 
      initData.requiredFields= ('nick,mail'.split(','))
    }
    
    if (false) {
      const otherData = false
      initData = Object.assign({}, initData, otherData)
    }
    
    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.querySelector('#vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config_change',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  if (typeof gtag === 'function') {
    gtag('config', '', {'page_path': window.location.pathname});
  }

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})


document.addEventListener('pjax:send', function () {
  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})</script><script>(function(){
  const bp = document.createElement('script');
  const curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  bp.dataset.pjax = ''
  const s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})()</script></div></body></html>