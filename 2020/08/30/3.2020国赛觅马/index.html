<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>2020国赛觅马wp | Ron's Blog</title><meta name="keywords" content="CTF,Crypto,wp"><meta name="author" content="Ron"><meta name="copyright" content="Ron"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="关于2020国赛初赛的觅马个人wp">
<meta property="og:type" content="article">
<meta property="og:title" content="2020国赛觅马wp">
<meta property="og:url" content="https://lucxer.tech/2020/08/30/3.2020%E5%9B%BD%E8%B5%9B%E8%A7%85%E9%A9%AC/index.html">
<meta property="og:site_name" content="Ron&#39;s Blog">
<meta property="og:description" content="关于2020国赛初赛的觅马个人wp">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/2020%E5%9B%BD%E8%B5%9B%E6%B5%B7%E6%8A%A5.png">
<meta property="article:published_time" content="2020-08-30T13:21:19.000Z">
<meta property="article:modified_time" content="2024-07-03T06:55:59.667Z">
<meta property="article:author" content="Ron">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Crypto">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/2020%E5%9B%BD%E8%B5%9B%E6%B5%B7%E6%8A%A5.png"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://lucxer.tech/2020/08/30/3.2020%E5%9B%BD%E8%B5%9B%E8%A7%85%E9%A9%AC/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="preconnect" href="//zz.bdstatic.com"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.js" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"9Y5QB7OMT4","apiKey":"c5dbda696103c1683d9cc595ad1d1e84","indexName":"blog","hits":{"per_page":6},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: true
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2024-07-03 14:55:59'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = '1'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}const fontSizeVal = saveToLocal.get('global-font-size')
if (fontSizeVal !== undefined) {
  document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
}})()</script><meta name="generator" content="Hexo 5.4.2"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">41</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">68</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/2020%E5%9B%BD%E8%B5%9B%E6%B5%B7%E6%8A%A5.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Ron's Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">2020国赛觅马wp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-08-30T13:21:19.000Z" title="发表于 2020-08-30 21:21:19">2020-08-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-07-03T06:55:59.667Z" title="更新于 2024-07-03 14:55:59">2024-07-03</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">4.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>15分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
<p>本篇是对《第十三届全国大学生信息安全竞赛创新实践能力赛（线上初赛）》参赛经历的一个整理。</p>
</blockquote>
<h2 id="bd"><a href="#bd" class="headerlink" title="bd"></a>bd</h2><p>题目描述如此：</p>
<blockquote>
<p>数学在密码学里面很重要的！现在知道吃亏了吧！</p>
</blockquote>
<p>显然，他说的是大实话，确实应该好好学习数学。</p>
<p>下载附件，可以看到里面是一个py文件，文件内容如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">N = p * q</span><br><span class="line">phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    d = getRandomNBitInteger(<span class="number">200</span>)</span><br><span class="line">    <span class="keyword">if</span> GCD(d, phi) == <span class="number">1</span>:</span><br><span class="line">        e = inverse(d, phi)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(c, e, N, sep=<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 37625098109081701774571613785279343908814425141123915351527903477451570893536663171806089364574293449414561630485312247061686191366669404389142347972565020570877175992098033759403318443705791866939363061966538210758611679849037990315161035649389943256526167843576617469134413191950908582922902210791377220066</span></span><br><span class="line"><span class="comment"># 46867417013414476511855705167486515292101865210840925173161828985833867821644239088991107524584028941183216735115986313719966458608881689802377181633111389920813814350964315420422257050287517851213109465823444767895817372377616723406116946259672358254060231210263961445286931270444042869857616609048537240249</span></span><br><span class="line"><span class="comment"># 86966590627372918010571457840724456774194080910694231109811773050866217415975647358784246153710824794652840306389428729923771431340699346354646708396564203957270393882105042714920060055401541794748437242707186192941546185666953574082803056612193004258064074902605834799171191314001030749992715155125694272289</span></span><br></pre></td></tr></table></figure>
<p>打开映入眼帘的就是pq等字样，毫无疑问，多半是一个RSA了。</p>
<p>然后，再对代码逐行看过之后，看到11行，<strong>生成的d是比较小的</strong>，同时可以看到21行打印的<strong>e是比较大的</strong>（和n相比）。</p>
<p>因此，这个是一个妥妥的 <code>RSA小解密指数攻击</code> 的题目。（常规题型，不了解请Google一下）</p>
<p>于是，贴上解密代码，一瞬得到flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> myrsa <span class="keyword">import</span> hack_d, decrypt</span><br><span class="line"></span><br><span class="line">n = <span class="number">86966590627372918010571457840724456774194080910694231109811773050866217415975647358784246153710824794652840306389428729923771431340699346354646708396564203957270393882105042714920060055401541794748437242707186192941546185666953574082803056612193004258064074902605834799171191314001030749992715155125694272289</span></span><br><span class="line">e = <span class="number">46867417013414476511855705167486515292101865210840925173161828985833867821644239088991107524584028941183216735115986313719966458608881689802377181633111389920813814350964315420422257050287517851213109465823444767895817372377616723406116946259672358254060231210263961445286931270444042869857616609048537240249</span></span><br><span class="line">c = <span class="number">37625098109081701774571613785279343908814425141123915351527903477451570893536663171806089364574293449414561630485312247061686191366669404389142347972565020570877175992098033759403318443705791866939363061966538210758611679849037990315161035649389943256526167843576617469134413191950908582922902210791377220066</span></span><br><span class="line"></span><br><span class="line">d = hack_d(e, n)</span><br><span class="line"></span><br><span class="line">flag = decrypt(c, d, n)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;d3752538-90d0-c373-cfef-9247d3e16848&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="lfsr"><a href="#lfsr" class="headerlink" title="lfsr"></a>lfsr</h2><p>题目描述如下：</p>
<blockquote>
<p>弱鸡看着题目给的信息束手无策，丈二和尚摸不着头脑 ，你嘿嘿一笑，拿出来了你随身带着的笔记本电脑，噼里啪啦的敲起来了键盘，清晰的函数逻辑和流程出现在了电脑屏幕上，你敲敲键盘，答案变出现在了电脑屏幕上。</p>
</blockquote>
<p>读完题目描述，觉得这段话索然无味。。。。。。</p>
<p>还是依旧下载文件，里面是两个文件，一个是加密的程序，另一个是程序的输出。</p>
<p>加密程序 <code>lfsr.py</code> 如下：（注释都是我打的，原文是没有的）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">N = <span class="number">100</span></span><br><span class="line">MASK = <span class="number">2</span>**(N+<span class="number">1</span>) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">state, mask</span>):</span><br><span class="line">    feedback = state &amp; mask</span><br><span class="line">    feed_bit = <span class="built_in">bin</span>(feedback)[<span class="number">2</span>:].count(<span class="string">&quot;1&quot;</span>) &amp; <span class="number">1</span>  <span class="comment"># feed_bit feedback中二进制位中1的个数是奇数个就是1</span></span><br><span class="line">    output_bit = state &amp; <span class="number">1</span> <span class="comment"># 输出位就是state的奇偶 所以初始的state就是偶数  所以output里面前某位（最多100位）联合起来就是初始state</span></span><br><span class="line">    state = (state &gt;&gt; <span class="number">1</span>) | (feed_bit &lt;&lt; (N-<span class="number">1</span>)) <span class="comment"># 就是把feed_bit填入最高位</span></span><br><span class="line">    <span class="keyword">return</span> state, output_bit</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">assert</span> flag.startswith(<span class="string">&quot;flag&#123;&quot;</span>)</span><br><span class="line">    <span class="keyword">assert</span> flag.endswith(<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    mask = <span class="built_in">int</span>(flag[<span class="number">5</span>:-<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">assert</span> mask.bit_length() == N</span><br><span class="line">    </span><br><span class="line">    state  = random.randint(<span class="number">0</span>, MASK) <span class="comment"># 最多100位</span></span><br><span class="line">    <span class="built_in">print</span>(state)</span><br><span class="line">    </span><br><span class="line">    outputs = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(N**<span class="number">2</span>):</span><br><span class="line">        state, output_bit = lfsr(state, mask)</span><br><span class="line">        outputs += <span class="built_in">str</span>(output_bit)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(outputs)</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<p>输出文件 <code>output.txt</code> 如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0100110011101111011111011010100111001010010100001111110110111101011110011111010010010111011100110111011001100001010010011101101000110110000011111011110000010100001001000011001011011011011001111110101111001010011011100010011110101100100101111001011100011110111101001010000000100100000111100101100100100000100110001111110011100110101000110100011001110110000110111111010111000001101110011001101111010110101000101011110111001011001111111000100100100011100100010101001100111011101111100110101011101101001001110010111011010011111001100001111111100001000001101101000001010100110011001101000101001010001001011000010111111100101111000000101000010110100110101001001100100011000111101000110011110101101111100110101010101000000001110010101001001111101001010111011110110001100101001111110111000110101011011010110101100011110010000011000110010111101010010000011101110111100011011110110001111010101011101100101101001111100100011000100101111011110001111100000110111000111111000111100000110011011011111110011111100010010110000010011100001010101011011101100011001100101100011001010010001101010011000000011110110111000000110001010010111110101011100000010100100001101011010101100110000101100010001010010111011000100001000001001110101011000010111000000010101100001010000010110110000111100011011000010111001111101110111010110000011001011101100000100000100010100100000010011010000111110010001111010000100011110000101111000110100010110101110001011101101100111000001110100100000000010011001110101110000001101100000001010111010011111000101101011001010011001101000111000010111111010101000011011001001110000011100100100010110101100001110110111001000001011111100101100011010010010110000011110100110000111011011010101110101001100110100101100101000100011001011000001011110010000011000110111011110011010001101100010010111110101101101110100111010000001101000011011010011110111101000000100011000000101001000000011010101010000100001110110000110011000111101011100100101111101111111110101000011010001101100010010100111000000010000101100100110101000001001011100011111001101001101100010100000111010101111011101111111101100000010000111110011101010100101110100101010100011110100100000111010001000100011010011100010011000001110110100110110010100100110111011001010010010100000110101110000011110010110100010101000110000111101011011010111101100111100101001101001101100111101000100101101100010111010010111100100111101101110101110011010110011111011111010000011000100010010101110001001000111111100100010100000001001010111010100010111001011011101110010110111110110100011111101110111011000111001010010110001001011011100110101111100100000101110000001011110011101110101101001011111100011001100111001011011001011011101000101100100011101000011101011010110010111111010011110111111111100001101101001101101111000100110010010100000100000100110100100110010000100101100000101010101000111110101001111111011011111101101110010100110000010110111001101110011101100001111111001110110010010011101111100111111000010011010010011100000001010011111111110001111110110110110001001001111011001101110110101100011010001111110010001011010000011110101100110010010001110010100010000000010101010010111011010101011011000010010011010110101101011100100101110001100000111110010101100010100010100010000101111000011111000111000011110001110110000011000100110010101111111111100011010000010010010111111110000000010100100101101101010111011000001010000000101011010110011101000110011011001110101101001001101100010011110001101001001000011001101100001101100000101111000001110100001100001000100000000011010011001001011110011000011011000100011011001011100111111000011011010000100000011110110011011110111000001011101101110110101000101011111110000100000111111110011111111100010101001000011010001110111111011100010111001110110001000101010001001001111111110111001101001001000110000110100000000010010100001010111101001110001011101011000100000001001001011111000100011111000011010001110001111111110111100010001110101011101011100010100000011110000100011001100000100111000111011011101000110010011010011110010010000111010001011111111010110011100111011110100111000101100100111001001010001000100011110101100100010000000000110010111101101111101011001101111000000000100000101001011110000010011110011000000100111001001110001000010011111010100001001010010100111111010111001001110110101010010100010010100101100000001010010111101101000110100111110000000111110000011110011001101010111101010111010111010000000110010001011110101110110001000110111101110101101001001100001101110001000100000110100000100000111110010110110010011111100010011111001110111011010101010001011111110000000011110001010011001101010110010101100101100110010111001100100111101000100010100010010100000010010111101100111110101101111101001010110010001111111001101010111110101111001000111101001110100000111111010000111000010101001001101100111001111111111100011010111110001101000100001010000000001101101001110001000001110010000010110001001001101010111111001001010100011011111011000011001001101000110010101000010100001001000011111001101101111011111001000010010111011010110010011010101100100000101100110110011011110000110011000000001011000111100101000011011011010010111000110101110101111100100010101010101000011000111000010001001000100110101111001001001111100110000101100010011101100001000010100010101110001111110101100101000101110000110010100101100101100101100100111111010100101010011100110100011111001000100010001101111111101011110100111001110101001101000010001011000111101110001010100101101111000110101001011101110110110110110101011010001110011111011110011010100110100111111010101111101111100110000110010111110110100110000011110110111111101111010011010000101010111100001111110110000001000001000011101001010010100100100000001101011101110011001011011110010111101111101010011010000110110101000100010110110101101010110110010011010011111111100001001000110111101001111000011001000010111100110001110110011011011100101011010101100011001111111000100000011100110011001001011000100010110000100001100011010000110110011100000111000010001011010001110010101000100010001001110001011001010000111010010101110001010100011101101110010111100010110010000011010111001101000100111011010100001010011100000100001010100010110100111000000001111100000100011100101011011101111111101101110011111010000110111101000001001110111000001000101100110100100111100100011011100010011111101010001101010100101110000110011000100001111100100001000000100011101101011011111000011110010110110101010011101000001111001011100101001001101111000011110000001010011010001110000111001101100011110011001100000111101001011000110111011001101101101100101100110100101011111111110110000111101000000100101011100111001111111011010100110010001000001101010001110010010000101111000001010100000101100000010101110100000000110011001011000011101101000000100111111010111110100011111101100001001110001100101100001010000100000110111101001101010000011100000000100000101101010010101111101100110110111000011100111001010010100101000111011001001110011111100010010010110100111101100110110111001011110010000111011111010101000010001101110011111010110011100010001111111011100110100011110110001101001110001010001110011110101111101011101100000111011011101110000110111101010001000011110011011101100011100101110100000100010110110011010101011000010010110000000100010011001110010011110010110111001111011010101111011000000111110000011011100100010011110010110000001111110111000100111010100110010111100010000110101011110011010110011001011011010010111001000000000001001010101010001100000110111101000000010100100010100101011111110011011100111101001110101010001100000100100110111110001111000011100010110001101101010011001011111101011000110110000111111101100000000001000010010010011101001000111100000010111011011001001100110000101010110001011000001011010111000111100111011010101010011100100100100010000001101001101010111110010100101000001100111110111111110000101111100110001110111010111001111110111100000111011011010111011001111010100010000111011111111000100110110001100000110101000001010010010100111011100000011111110001000010011010101001111010111100011110110110111000000111101010110001100000100001101101001101010111110001101101100101101101001000100000100110111111010011010011111010110110111101001000100010111101100011010111011111010011110000100001100101101111110010101000000101111101000001111110100000001011011111111100100110101101011100101101001011010001100010101101100000101000001110110101010100001011100010000111010011101110000000010000000000010111100111000010000000110110011011101110000001111011100011101111100011000011001000100111010101011010101110011010011011011010100011011000110111101001110011110000100010011000010000001101010010011000111000000000101100011010001000100010100100100011000101110100010001111101001010100001000000110010011101011101000000100010000011010110100111110101110001111001000000101011101010111110110100100011010000011010111111001001111101101110111110111000001010111100010001001001100000000110011100001100100111010011111011001010001101111111000010110101000011100001010110100101110111001001100000000110110101011001110000011001111100001101110100101101111100110001010011011001010110111000100010000110001111101110011100001101000100110000111000110001011011110100010101011011001001111101001110011100001110001010100011001110110101101001101010101001110011110001011101011100100001101100110110110101011101010110011100000001011010111011101000000101110111110010000000000101001110011111011001110001100010111001010010110011100001000011111101111101100111000101011100011000001100000000000010000111111010010101110101011100010100001000000100111111010111110010010111010110010100111000010111100000000100010111010010011010011001100010001000001100110100101110100110110111101010001100001010011111011100000010110110110000000100101100110100101100111001010100010001011010001010011110100110101000110001110000100111111001000110011110010111000110010001111111111101011110100111101001001101110110011111000110010111000011011111001110101101101000011010101011010111101011101111011100101001111111000101100100000011000100101001011001011110001101001100101001</span><br></pre></td></tr></table></figure>
<p>下载之后，一开始我一脸懵逼，不知道这是在考什么。</p>
<p>于是我就Google了一下 “lfsr”，结果Google给了我这个↓</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/lfsr.png" alt="lfsr"></p>
<p>哎呀！我这个觅马菜鸡，觅马学都没学好，居然对学过的LFSR都不敏感了。 <strong>Linear（线性） Feedback（反馈） Shift（移位） Register（寄存器）</strong> 看看多好记的。</p>
<blockquote>
<p>不知道的同学可以随便先去了解下</p>
</blockquote>
<p>简单说说（意思就是我个人的理解，不代表真实定义）这个<strong>反馈移位寄存器，FSR</strong>就是下面这个图的样子👇，</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/FSR.png" alt="FSR"></p>
<blockquote>
<p>有一个框框有固定长度n，每一个小格子中的数<strong>要么是0，要么是1</strong>，我们就可以称其为<strong>寄存器</strong>，代码中可以用数组来模拟。</p>
<p>这个框框每次都从右边输出固定m位的a<sub>i</sub>，然后就会往右移动m位，再利用<strong>某种算法</strong>计算出m个数，依次填在左边的m位，这样是不是就是相当于移动起来了？于是就可以称其位<strong>移位寄存器</strong>。一般情况下，都是输出一位，移动一位，计算出新的一位，即m=1。下面都以m=1来谈。</p>
<p>上面提到的<strong>某种算法</strong>，在这里我们就称之为，<strong>“反馈函数”</strong>，表达式为 a<sub>n+1</sub> = f(a<sub>n</sub>, a<sub>n-1</sub>,,,,,a<sub>1</sub>)  这样通过前面的n个状态，我们就可以推算出下一个状态。</p>
<p>当这里的<strong>反馈函数</strong>为线性函数时，我们就称其为 <strong>“线性反馈移位寄存器”</strong>，那么在GF(2)上（不知道的同学可以简单理解为取值只有0和1），线性函数的即是寄存器中的某些位的异或。<del>（不要问我怎么知道的，想想那异或运算的性质，0和1的计算结果还是0和1，我们就可以简单地通过是仅仅选择某些位来进行异或）</del> 此时，反馈函数就是下面这样👇</p>
<script type="math/tex; mode=display">
\begin{equation}
    f(a_1,a_2,...,a_n) = c_1a_1 \oplus c_2a_2 \oplus ... \oplus c_na_n
\end{equation}</script><p>其中c<sub>i</sub> 取值只能是0或者1，为0可以理解为没有选择这一位，为1可以理解为选择了这一位。</p>
</blockquote>
<p>那既然咱已经学过了，应该还是有可能做得出来哦。那代码肯定就是整了一个LFSR来构建流觅马咯。那就康康代码先。</p>
<p>果然，代码第8~13行定义了一个 <code>lfsr</code> 函数了作为LFSR。我们暂且跳过它，看 <code>main</code> 函数。</p>
<p>16~17行就是告诉我们，flag 是 <code>flag&#123;***************&#125;</code> 这个样子的。 20行就是告诉我们中间需要我们求的部分是100位的（<strong>二进制位哈</strong>）。然后它把我们要的 flag 变成了它的 <code>mask</code> 了，<strong>所以我们就是要整出来这个玩意，就是我们要的 flag 了</strong>。22行，接着它随机了一个 <code>state</code>，也是最多100位的。26~32行它把 LFSR 的前10000个输出结果告诉我们了。 </p>
<p>接下来就是分析 <code>lfsr</code> ：</p>
<p>第9行，其将输入的 <code>state</code> 和 <code>mask</code> 进行了一个<strong>与操作</strong>，并赋值给了 <code>feedback</code>，暂且不懂其意义，但是多半是反馈函数的一部分，毕竟 <code>feedback</code> 的英文意思在这里，搁置先。</p>
<p>第10行，将上面与运算后的结果 <code>feedback</code> 转化为了2进制，然后切片去掉了前面的’0b’字段， <code>.count(&quot;1&quot;)</code> 是个什么玩意？？不过顾名思义，应该或许大概就是统计1的个数。关于这一点，可以自己写一个py很好进行验证。结果证明就是这样。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="built_in">bin</span>(<span class="number">5</span>)[<span class="number">2</span>:].count(<span class="string">&quot;1&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5 = 101</span></span><br><span class="line"><span class="comment"># s = 2</span></span><br></pre></td></tr></table></figure>
<p>然后又与了一个1，那就是第10行是在判断，<code>state</code> 和 <code>mask</code> 中一样都是1的个数是奇数个还是偶数个。</p>
<p>第11行，就是将当前的 <code>state</code> 的最后一位赋值给 <code>output_bit</code> </p>
<p>第12行，就是将 <code>state</code> 右移1位再和 <code>feed_bit</code> 左移 N-1位相或。并更新 <code>state</code> 。那到这里，也即是说 <code>state</code> 就是我们前面所说的 <strong>那个框框</strong>。而12行就是将原来的 <code>state</code>  右移1位，<code>feed_bit</code> 填在了最高位，也就是说，<code>feed_bit</code> 就是反馈函数的输出。</p>
<p>第13行，就将新寄存器（<strong>那个框框</strong>）和旧寄存器的最后一位返回出去了。而后者就是在我们的output文件中。</p>
<p>再回到前面可以看到，9行和10行，就是我们的反馈函数。</p>
<p>那么，如果我们知道寄存器的位数，即最前面随机生成的 <code>state</code> 的位数，其实我们是可以知道寄存器的初始状态的。也就是output的前多少位，因为不管怎么反馈，初始状态的值是肯定会全部一位一位地输出完了，才会输出新的生成的值，所以输出的前面部分就是一定是 <code>state</code> 的初始值，只是现在不知道位数，无法确定具体是哪些。</p>
<p>现在，才到了问题最关键的地方，怎么把9行和10行，转化为我们前面的公式（1） 的样儿呢？</p>
<p><strong>思考思考思考……</strong></p>
<p>好的，我思考出来了。</p>
<p>为了方便，我们把公式（1）给贴一份到这里。</p>
<script type="math/tex; mode=display">
\begin{equation}
    f(a_1,a_2,...,a_n) = c_1a_1 \oplus c_2a_2 \oplus ... \oplus c_na_n
\end{equation}</script><p>然后考虑第9行和第10行代码，为了方便，也贴这里。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">feedback = state &amp; mask</span><br><span class="line">feed_bit = <span class="built_in">bin</span>(feedback)[<span class="number">2</span>:].count(<span class="string">&quot;1&quot;</span>) &amp; <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>因为是在按位进行与，所以我们可以把他们看做一个等长的bool数组。于是可以将第9行转化为👇这个。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">feedback[i] = state[i] &amp; mask[i] </span><br><span class="line"><span class="comment"># i from 0 to length</span></span><br></pre></td></tr></table></figure>
<p>那原代码的第10行，不就是在看这些所有的 <code>feedback[i]</code> 中1的个数是奇数还是偶数嘛？</p>
<p>那一堆01的串，你要统计他的个数是奇数还是偶数，除了一个个数，还能怎么计算呢？</p>
<p>那你试试，把他们这一堆01的串，逐位进行异或会怎么样呢？</p>
<p><strong>好吧，事实就是这样，你把一堆01串逐位异或起来得到的结果，和你直接去数1的个数是奇数还是偶数，再与上1进行判断，结果是一样的。</strong>如公式（3）所示：</p>
<script type="math/tex; mode=display">
feed\_bit == (\sum\limits_{k=1}^na_k) \& 1 == a_1\oplus a_2 \ \oplus ... \oplus\ a_n \ ,\ \forall\ a_k \in \{0\ ,\ 1\}</script><p>那既然这样了，岂不是就已经可以得到 反馈函数了？如果把公式（3）中的 a<sub>k</sub> 视作 <code>feedback[k]</code> 是不是就ok了？</p>
<blockquote>
<p>原来的代码的第10行，不正是公式（3）中的左半部分吗？统计1的个数和把他们直接加起来是一样的效果吧？毕竟取值只有0和1</p>
</blockquote>
<p>于是，我们可以把原来第10行，直接相当于公式（3）中的右半部分，对吧？那么和我们想要的反馈函数，公式（1）相比，差了什么呢？是不是就是 a<sub>k</sub> 前面的系数 c<sub>k</sub> ?</p>
<p>那其实我们知道 <code>feedback</code> 只是一个中间变量，我们其实是不需要它的，<strong>我们事实上是关心的 <code>state</code> 毕竟他才是寄存器。</strong> 而反馈函数中的每一个 a<sub>k</sub> 其实都是寄存器中的一个元素。因此，刚才我们将 <code>feedback[k]</code> 这个中间变量视作了 a<sub>k</sub> ，现在我们要给他还回去，变成 <code>state[k]</code> ，而原代码的第9行，不就是 <code>state</code> 和 <code>feedback</code> 的关系吗？而且刚好是 <strong>与关系</strong> 。看到这里明白了吧？ <code>state[k]</code> 才是我们的 a<sub>k</sub> 而 <code>mask[k]</code> 则刚好构成我们的 c<sub>k</sub>。</p>
<blockquote>
<p>如果还是很迷，不妨回到刚才， a<sub>k</sub> 视作 <code>feedback[k]</code> 。 那么 <code>feedback[k]</code> = <code>state[k]</code> &amp; <code>mask[k]</code> 没毛病吧？然后在换元，把a<sub>k</sub> 替换成 <code>state[k]</code> &amp; <code>mask[k]</code> 为了书写方便，我们可以将 <code>state[k]</code>  记为 b<sub>k</sub> 将 <code>mask[k]</code> 记为 c<sub>k</sub> 。于是公式（3）就是公式（4）</p>
</blockquote>
<script type="math/tex; mode=display">
feed\_bit == a_1\oplus a_2 \ \oplus ... \oplus\ a_n \  == c_1b_1 \oplus c_2b_2 \oplus ... \oplus c_nb_n</script><p>可以看到，此时，公式（4）的最左侧和最右侧。 b<sub>k</sub> 是 <code>state</code> (寄存器)此时的状态，而 c<sub>k</sub> 是 <code>mask</code> ，而 <code>feed_bit</code> 是寄存器的反馈状态，也就是下一位，用这里的统一符号就是 <code>feed_bit</code> 就是 b<sub>N+1</sub> (N 是寄存器的位数)。<strong>为了表示习惯的统一，我们还是将b换为a统一表示</strong>，就有了下面的公式（5的 <strong>反馈函数</strong>：</p>
<script type="math/tex; mode=display">
a_{n+1} = c_1a_1 \oplus c_2a_2 \oplus ... \oplus c_na_n</script><p><strong>那么现在，问题就很清楚了，我们要找的 flag 就是mask，而mask就是我们反馈函数中的系数 c<sub>k</sub>，我们把这个玩意求出来了，flag就到手了。</strong></p>
<p>偶滴个乖乖讲了半天，还是不知道这个c<sub>k</sub> 咋求哒。莫方莫方。接下来就快了。</p>
<p>根据公式（5）我们能得到什么？ 能得到公式（6）。</p>
<script type="math/tex; mode=display">
a_{n+1} = c_1a_1 \oplus c_2a_2 \oplus ... \oplus c_na_n \\ a_{n+2} = c_1a_2 \oplus c_2a_3 \oplus ... \oplus c_na_{n+1} \\ a_{n+3} = c_1a_3 \oplus c_2a_4 \oplus ... \oplus c_na_{n+2} \\ \vdots \\a_{n+n} = c_1a_n \oplus c_2a_{n+1} \oplus ... \oplus c_na_{n+(n-1)} \\</script><p>公式（6）太过于冗余不好看，我们给它换一个写法。写作如下的矩阵形式。</p>
<script type="math/tex; mode=display">
\begin{pmatrix}
a_{n + 1} \\
a_{n + 2} \\
\vdots \\
a_{n + n} \\
\end{pmatrix}

=

\begin{pmatrix}
a_1 \quad a_2      & \cdots & \quad a_n \\
a_2 \quad a_3      & \cdots & a_{n+1}  \\
\vdots \quad \vdots & \ddots & \vdots \\
a_n \quad a_{n+1}      & \cdots & a_{n+n}  
\end{pmatrix}

\times

\begin{pmatrix}
c_1 \\
c_2 \\
\vdots \\
c_n \\
\end{pmatrix}

=

A

\begin{pmatrix}
c_1 \\
c_2 \\
\vdots \\
c_n \\
\end{pmatrix}</script><p>那么，根据公式（7），显然，如果我们能得到 <code>2*n</code> 个 a<sub>k</sub> ，我们就能构造出上述的A矩阵和左边的列向量。同时，如果A是可逆的。我们可以直接左乘一个 A<sup>-1</sup> 就可得到系数向量 <code>c</code> 了。即</p>
<script type="math/tex; mode=display">
\begin{pmatrix}
c_1 \\
c_2 \\
\vdots \\
c_n \\
\end{pmatrix}

=
A^{-1}

\begin{pmatrix}
a_{n + 1} \\
a_{n + 2} \\
\vdots \\
a_{n + n} \\
\end{pmatrix}</script><p>于是这个题就迎刃而解了。题目中给了 n<sup>2</sup> 位输出，所以我们直接枚举就好。虽然不知道n是多少，但是可以枚举n从2~100。然后求出mask，即flag。</p>
<blockquote>
<p>这里有个小投机，虽然不知道n的大小，但是我们知道flag是100位的，所以只把100位的flag打出来就好了</p>
</blockquote>
<p>下面就直接贴代码了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">output = <span class="string">&#x27;0100110011101111011111011010100111001010010100001111110110111101011110011111010010010111011100110111011001100001010010011101101000110110000011111011110000010100001001000011001011011011011001111110101111001010011011100010011110101100100101111001011100011110111101001010000000100100000111100101100100100000100110001111110011100110101000110100011001110110000110111111010111000001101110011001101111010110101000101011110111001011001111111000100100100011100100010101001100111011101111100110101011101101001001110010111011010011111001100001111111100001000001101101000001010100110011001101000101001010001001011000010111111100101111000000101000010110100110101001001100100011000111101000110011110101101111100110101010101000000001110010101001001111101001010111011110110001100101001111110111000110101011011010110101100011110010000011000110010111101010010000011101110111100011011110110001111010101011101100101101001111100100011000100101111011110001111100000110111000111111000111100000110011011011111110011111100010010110000010011100001010101011011101100011001100101100011001010010001101010011000000011110110111000000110001010010111110101011100000010100100001101011010101100110000101100010001010010111011000100001000001001110101011000010111000000010101100001010000010110110000111100011011000010111001111101110111010110000011001011101100000100000100010100100000010011010000111110010001111010000100011110000101111000110100010110101110001011101101100111000001110100100000000010011001110101110000001101100000001010111010011111000101101011001010011001101000111000010111111010101000011011001001110000011100100100010110101100001110110111001000001011111100101100011010010010110000011110100110000111011011010101110101001100110100101100101000100011001011000001011110010000011000110111011110011010001101100010010111110101101101110100111010000001101000011011010011110111101000000100011000000101001000000011010101010000100001110110000110011000111101011100100101111101111111110101000011010001101100010010100111000000010000101100100110101000001001011100011111001101001101100010100000111010101111011101111111101100000010000111110011101010100101110100101010100011110100100000111010001000100011010011100010011000001110110100110110010100100110111011001010010010100000110101110000011110010110100010101000110000111101011011010111101100111100101001101001101100111101000100101101100010111010010111100100111101101110101110011010110011111011111010000011000100010010101110001001000111111100100010100000001001010111010100010111001011011101110010110111110110100011111101110111011000111001010010110001001011011100110101111100100000101110000001011110011101110101101001011111100011001100111001011011001011011101000101100100011101000011101011010110010111111010011110111111111100001101101001101101111000100110010010100000100000100110100100110010000100101100000101010101000111110101001111111011011111101101110010100110000010110111001101110011101100001111111001110110010010011101111100111111000010011010010011100000001010011111111110001111110110110110001001001111011001101110110101100011010001111110010001011010000011110101100110010010001110010100010000000010101010010111011010101011011000010010011010110101101011100100101110001100000111110010101100010100010100010000101111000011111000111000011110001110110000011000100110010101111111111100011010000010010010111111110000000010100100101101101010111011000001010000000101011010110011101000110011011001110101101001001101100010011110001101001001000011001101100001101100000101111000001110100001100001000100000000011010011001001011110011000011011000100011011001011100111111000011011010000100000011110110011011110111000001011101101110110101000101011111110000100000111111110011111111100010101001000011010001110111111011100010111001110110001000101010001001001111111110111001101001001000110000110100000000010010100001010111101001110001011101011000100000001001001011111000100011111000011010001110001111111110111100010001110101011101011100010100000011110000100011001100000100111000111011011101000110010011010011110010010000111010001011111111010110011100111011110100111000101100100111001001010001000100011110101100100010000000000110010111101101111101011001101111000000000100000101001011110000010011110011000000100111001001110001000010011111010100001001010010100111111010111001001110110101010010100010010100101100000001010010111101101000110100111110000000111110000011110011001101010111101010111010111010000000110010001011110101110110001000110111101110101101001001100001101110001000100000110100000100000111110010110110010011111100010011111001110111011010101010001011111110000000011110001010011001101010110010101100101100110010111001100100111101000100010100010010100000010010111101100111110101101111101001010110010001111111001101010111110101111001000111101001110100000111111010000111000010101001001101100111001111111111100011010111110001101000100001010000000001101101001110001000001110010000010110001001001101010111111001001010100011011111011000011001001101000110010101000010100001001000011111001101101111011111001000010010111011010110010011010101100100000101100110110011011110000110011000000001011000111100101000011011011010010111000110101110101111100100010101010101000011000111000010001001000100110101111001001001111100110000101100010011101100001000010100010101110001111110101100101000101110000110010100101100101100101100100111111010100101010011100110100011111001000100010001101111111101011110100111001110101001101000010001011000111101110001010100101101111000110101001011101110110110110110101011010001110011111011110011010100110100111111010101111101111100110000110010111110110100110000011110110111111101111010011010000101010111100001111110110000001000001000011101001010010100100100000001101011101110011001011011110010111101111101010011010000110110101000100010110110101101010110110010011010011111111100001001000110111101001111000011001000010111100110001110110011011011100101011010101100011001111111000100000011100110011001001011000100010110000100001100011010000110110011100000111000010001011010001110010101000100010001001110001011001010000111010010101110001010100011101101110010111100010110010000011010111001101000100111011010100001010011100000100001010100010110100111000000001111100000100011100101011011101111111101101110011111010000110111101000001001110111000001000101100110100100111100100011011100010011111101010001101010100101110000110011000100001111100100001000000100011101101011011111000011110010110110101010011101000001111001011100101001001101111000011110000001010011010001110000111001101100011110011001100000111101001011000110111011001101101101100101100110100101011111111110110000111101000000100101011100111001111111011010100110010001000001101010001110010010000101111000001010100000101100000010101110100000000110011001011000011101101000000100111111010111110100011111101100001001110001100101100001010000100000110111101001101010000011100000000100000101101010010101111101100110110111000011100111001010010100101000111011001001110011111100010010010110100111101100110110111001011110010000111011111010101000010001101110011111010110011100010001111111011100110100011110110001101001110001010001110011110101111101011101100000111011011101110000110111101010001000011110011011101100011100101110100000100010110110011010101011000010010110000000100010011001110010011110010110111001111011010101111011000000111110000011011100100010011110010110000001111110111000100111010100110010111100010000110101011110011010110011001011011010010111001000000000001001010101010001100000110111101000000010100100010100101011111110011011100111101001110101010001100000100100110111110001111000011100010110001101101010011001011111101011000110110000111111101100000000001000010010010011101001000111100000010111011011001001100110000101010110001011000001011010111000111100111011010101010011100100100100010000001101001101010111110010100101000001100111110111111110000101111100110001110111010111001111110111100000111011011010111011001111010100010000111011111111000100110110001100000110101000001010010010100111011100000011111110001000010011010101001111010111100011110110110111000000111101010110001100000100001101101001101010111110001101101100101101101001000100000100110111111010011010011111010110110111101001000100010111101100011010111011111010011110000100001100101101111110010101000000101111101000001111110100000001011011111111100100110101101011100101101001011010001100010101101100000101000001110110101010100001011100010000111010011101110000000010000000000010111100111000010000000110110011011101110000001111011100011101111100011000011001000100111010101011010101110011010011011011010100011011000110111101001110011110000100010011000010000001101010010011000111000000000101100011010001000100010100100100011000101110100010001111101001010100001000000110010011101011101000000100010000011010110100111110101110001111001000000101011101010111110110100100011010000011010111111001001111101101110111110111000001010111100010001001001100000000110011100001100100111010011111011001010001101111111000010110101000011100001010110100101110111001001100000000110110101011001110000011001111100001101110100101101111100110001010011011001010110111000100010000110001111101110011100001101000100110000111000110001011011110100010101011011001001111101001110011100001110001010100011001110110101101001101010101001110011110001011101011100100001101100110110110101011101010110011100000001011010111011101000000101110111110010000000000101001110011111011001110001100010111001010010110011100001000011111101111101100111000101011100011000001100000000000010000111111010010101110101011100010100001000000100111111010111110010010111010110010100111000010111100000000100010111010010011010011001100010001000001100110100101110100110110111101010001100001010011111011100000010110110110000000100101100110100101100111001010100010001011010001010011110100110101000110001110000100111111001000110011110010111000110010001111111111101011110100111101001001101110110011111000110010111000011011111001110101101101000011010101011010111101011101111011100101001111111000101100100000011000100101001011001011110001101001100101001&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">work</span>(<span class="params">n, key</span>):</span><br><span class="line">    array_1 = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            array_1.append(<span class="built_in">int</span>(key[i + j]))</span><br><span class="line">    A = matrix(GF(<span class="number">2</span>), n, n, array_1)</span><br><span class="line">    array_2 = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        array_2.append(<span class="built_in">int</span>(key[i + n]))</span><br><span class="line">    B = matrix(GF(<span class="number">2</span>), n, <span class="number">1</span>, array_2)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        c = A.solve_right(B)</span><br><span class="line">        <span class="keyword">return</span> c</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">100</span>):</span><br><span class="line">    c = work(n = n, key = output)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(c) == <span class="number">100</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">tmp = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> c[::-<span class="number">1</span>]:</span><br><span class="line">	tmp += <span class="built_in">str</span>(x[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;flag&#123;&#x27;</span> + <span class="built_in">str</span>(<span class="built_in">int</span>(tmp, <span class="number">2</span>)) + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;856137228707110492246853478448&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h2><p>题目描述如下：</p>
<blockquote>
<p>小明经过研究，发现RSA加密算法可以推广，也就是它的模不仅仅是只能为两个素数的乘积，只要是2个以上不同的素数相乘都可以。</p>
</blockquote>
<p>根据题目和描述，这个题是一个多质数的RSA<strong>（multi-prime RSA）</strong> </p>
<p>给出的文件 <code>cipher.txt</code> 很简单，就只有n,e,c</p>
<blockquote>
<p>n = 50142032499469550407421604706771611415193641755639270667473328045908799316205905505167271138079522738272643811917325451177986948493659090203974349370248583120022500722759239305447823602875823849366662503027591858371125301505134216095903796534740686834236150999<br>e = 65537<br>c = 45005399504992587510006608300548120810512973768886391125598523343330913326304417790989607300367232977960116381108873363343598357102136548218343380795022179607741940866191404186680657699739176842869814452906110393321567314747096161480003824583613027819960172221</p>
</blockquote>
<p>显然，这个题我们只有分解n，因为e是安全的，同时没有额外的信息，能利用的仅仅就是n有多个因数。</p>
<p>那么，二话不说，暴力分解走起。</p>
<p>遗憾的是，在线查找和yafu分解都失败了。yafu跑了好久都没有出来。</p>
<p>于是，我又尝试，自己手动来，从小质数开始枚举，一直枚举到了第100000*70个质数，还是没有成功枚举到一个因子。</p>
<p>这说明，这个n是没有小质因数的。</p>
<p>同时他又有多个质因数。</p>
<p><strong>猜测1：</strong>因此他的各个质因数的差距应该不大。</p>
<p>然后，我开始Google，毕竟我坚信这个是一种我没见过的新题型。看了好多英文论文，但是感觉写得都很垃圾。<del>（我英文垃圾，时间又很紧迫）</del> 各个论文都证明了半天，但是我感觉没啥用。倒是<strong>Google的搜索结果中，针对这种multi-prime RSA的攻击基本上都是基于他的质因数差异比较小来进行的。</strong> 这更加坚定了我的<strong>猜测1</strong>。</p>
<p>于是，借鉴普通RSA问题中，p和q太接近时的费马分解法的思路</p>
<blockquote>
<p>由于n = p * q,当p和q的差距太小时，这意味着p和q都会在 n<sup>1/2</sup> 附近。由于差距较小，所以我们可以在这个差距范围内进行枚举，进而实现对n的分解。</p>
</blockquote>
<p>我局得这个多因数的也是可以用类似的手法进行攻击的。</p>
<p>于是我枚举根次，从3枚举到20，每个附近的差异我定义为10亿。</p>
<p>代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = gmpy2.mpz(<span class="number">50142032499469550407421604706771611415193641755639270667473328045908799316205905505167271138079522738272643811917325451177986948493659090203974349370248583120022500722759239305447823602875823849366662503027591858371125301505134216095903796534740686834236150999</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 猜测的差异范围</span></span><br><span class="line">tot = <span class="number">1000000000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, <span class="number">21</span>):</span><br><span class="line">    </span><br><span class="line">    p0 = gmpy2.iroot(n, num)[<span class="number">0</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(tot):</span><br><span class="line">        <span class="keyword">if</span> n % (p0 + i) == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(p0 + i)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> n % (p0 - i) == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(p0 - i)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>很可惜，我没有跑出来它的因数，于是我又扩大了范围从20~100.</p>
<p>终于跑完了之后，我还是没有得到解。</p>
<p>于是我又扎进了寻找论文和Google方法中，<strong>因为我坚信，这是一类有其他方法一瞬得到结果的</strong>。</p>
<p>很遗憾，我没有在规定时间内拿到flag</p>
<p>赛后，我从同学哪里得知，<strong>开3次方根，将范围改到 2<sup>30</sup> 次方就可以爆破出来</strong>。</p>
<p>于是，新的代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">n = gmpy2.mpz(<span class="number">50142032499469550407421604706771611415193641755639270667473328045908799316205905505167271138079522738272643811917325451177986948493659090203974349370248583120022500722759239305447823602875823849366662503027591858371125301505134216095903796534740686834236150999</span>)</span><br><span class="line"></span><br><span class="line">p0 = gmpy2.iroot(n, <span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">tot = <span class="number">1</span> &lt;&lt; <span class="number">30</span></span><br><span class="line"></span><br><span class="line">start = time()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(tot):</span><br><span class="line">	<span class="keyword">if</span> n % (p0 + i) == <span class="number">0</span>:</span><br><span class="line">		<span class="built_in">print</span>(p0 + i)</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">if</span> n % (p0 - i) == <span class="number">0</span>:</span><br><span class="line">		<span class="built_in">print</span>(p0 - i)</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">end = time()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;用时：<span class="subst">&#123;end - start&#125;</span> s&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>我计了一个时，442秒，就成功爆破出了n的一个质因数，后面就简单了，直接yafu分解剩下的部分，然后就可以得到flag。 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;4e9f2a7f-bda9-4a46-af51-b29e0c61973e&#125;</span><br></pre></td></tr></table></figure>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/73741824.png" alt="73741824"></p>
<p><del><strong>我算了算，2<sup>30</sup> - 10<sup>9</sup> = 73741824</strong>，原来我离AK，甚至一血只差了73741824。</del></p>
<p><strong>谨以此，已备忘。</strong></p>
<h2 id="参考链接："><a href="#参考链接：" class="headerlink" title="参考链接："></a>参考链接：</h2><ul>
<li><a target="_blank" rel="noopener" href="https://nonuplebroken.com/2020/06/10/反馈移位寄存器/#反馈移位寄存器">https://nonuplebroken.com/2020/06/10/%E5%8F%8D%E9%A6%88%E7%A7%BB%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8/#%E5%8F%8D%E9%A6%88%E7%A7%BB%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8</a></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Ron</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://lucxer.tech/2020/08/30/3.2020%E5%9B%BD%E8%B5%9B%E8%A7%85%E9%A9%AC/">https://lucxer.tech/2020/08/30/3.2020%E5%9B%BD%E8%B5%9B%E8%A7%85%E9%A9%AC/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://lucxer.tech" target="_blank">Ron's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/Crypto/">Crypto</a><a class="post-meta__tags" href="/tags/wp/">wp</a></div><div class="post_share"><div class="addthis_inline_share_toolbox"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=5fb3e45d5f9ff11c" async="async"></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.png" target="_blank"><img class="post-qr-code-img" data-lazy-src="/img/wechat.png" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" data-lazy-src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/09/15/4.latex%E9%85%8D%E7%BD%AE/"><img class="prev-cover" data-lazy-src="https://www.latex-project.org/img/latex-project-logo.svg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Windows 下 latex 配置</div></div></a></div><div class="next-post pull-right"><a href="/2020/08/11/2.%E6%9D%82%E9%A1%B9/"><img class="next-cover" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/helpful-tips-picture-id933100878.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">杂项</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/08/20/22.RSA-直接分解/" title="RSA-1 直接分解模数"><img class="cover" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/RSA-1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-20</div><div class="title">RSA-1 直接分解模数</div></div></a></div><div><a href="/2021/08/22/23.RSA-因子差异过大或过小/" title="RSA-2 因子差异过大或过小"><img class="cover" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/RSA-2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-22</div><div class="title">RSA-2 因子差异过大或过小</div></div></a></div><div><a href="/2021/08/20/20.CTF中密码学常见出题/" title="CTF 中常见密码题基础"><img class="cover" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/Pigpen_cipher.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-20</div><div class="title">CTF 中常见密码题基础</div></div></a></div><div><a href="/2021/08/25/24.RSA-n多质因数攻击/" title="RSA-3 模数 n 多质因数攻击"><img class="cover" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/RSA-3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-25</div><div class="title">RSA-3 模数 n 多质因数攻击</div></div></a></div><div><a href="/2021/08/29/25.RSA-e和φ(n)不互质/" title="RSA-4 e 和 ɸ(n) 不互质"><img class="cover" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/RSA-4.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-29</div><div class="title">RSA-4 e 和 ɸ(n) 不互质</div></div></a></div><div><a href="/2021/09/04/27.RSA-共模攻击/" title="RSA-6 共模攻击"><img class="cover" data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/RSA-6.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-09-04</div><div class="title">RSA-6 共模攻击</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" data-lazy-src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Ron</div><div class="author-info__description">(retired) OI/Crypto, Fuzzing</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">41</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">68</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/qriosa"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/qriosa" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:chegnxiang@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">号外！号外！评论系统已开放！</div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#bd"><span class="toc-number">1.</span> <span class="toc-text">bd</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lfsr"><span class="toc-number">2.</span> <span class="toc-text">lfsr</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rsa"><span class="toc-number">3.</span> <span class="toc-text">rsa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5%EF%BC%9A"><span class="toc-number">4.</span> <span class="toc-text">参考链接：</span></a></li></ol></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/12/09/41.CVE-2018-18708%E8%B0%83%E8%AF%95%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/" title="CVE-2018-18708 调试复现分析"><img data-lazy-src="https://www.tenda.com.cn/logo.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CVE-2018-18708 调试复现分析"/></a><div class="content"><a class="title" href="/2024/12/09/41.CVE-2018-18708%E8%B0%83%E8%AF%95%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/" title="CVE-2018-18708 调试复现分析">CVE-2018-18708 调试复现分析</a><time datetime="2024-12-09T12:40:46.000Z" title="发表于 2024-12-09 20:40:46">2024-12-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/11/19/39.CVE-2024-2961%E8%B0%83%E8%AF%95%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/" title="CVE-2024-2961 调试复现分析"><img data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/CVE-2024-2961-heap-page.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CVE-2024-2961 调试复现分析"/></a><div class="content"><a class="title" href="/2024/11/19/39.CVE-2024-2961%E8%B0%83%E8%AF%95%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/" title="CVE-2024-2961 调试复现分析">CVE-2024-2961 调试复现分析</a><time datetime="2024-11-19T13:12:11.000Z" title="发表于 2024-11-19 21:12:11">2024-11-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/29/40.CVE-2018-5767%E8%B0%83%E8%AF%95%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/" title="CVE-2018-5767 调试复现分析"><img data-lazy-src="https://www.tenda.com.cn/logo.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CVE-2018-5767 调试复现分析"/></a><div class="content"><a class="title" href="/2024/03/29/40.CVE-2018-5767%E8%B0%83%E8%AF%95%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/" title="CVE-2018-5767 调试复现分析">CVE-2018-5767 调试复现分析</a><time datetime="2024-03-29T14:07:12.000Z" title="发表于 2024-03-29 22:07:12">2024-03-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/18/38.CVE-2018-1160%E8%B0%83%E8%AF%95%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/" title="CVE-2018-1160 调试复现分析"><img data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/CVE-2018-1160-control_flow_hijack_chart.svg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CVE-2018-1160 调试复现分析"/></a><div class="content"><a class="title" href="/2023/10/18/38.CVE-2018-1160%E8%B0%83%E8%AF%95%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/" title="CVE-2018-1160 调试复现分析">CVE-2018-1160 调试复现分析</a><time datetime="2023-10-18T12:42:19.000Z" title="发表于 2023-10-18 20:42:19">2023-10-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/09/21/37.CVE-2021-30145%E8%B0%83%E8%AF%95%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/" title="CVE-2021-30145 调试复现分析"><img data-lazy-src="https://cdn.jsdelivr.net/gh/qriosa/picgo-blog/img/CVE-2021-30145-process.svg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CVE-2021-30145 调试复现分析"/></a><div class="content"><a class="title" href="/2023/09/21/37.CVE-2021-30145%E8%B0%83%E8%AF%95%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/" title="CVE-2021-30145 调试复现分析">CVE-2021-30145 调试复现分析</a><time datetime="2023-09-21T04:11:11.000Z" title="发表于 2023-09-21 12:11:11">2023-09-21</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Ron</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to <a href="https://lucxer.tech">Ron's home</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.spacingElementById('content-inner')
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.spacingElementById('content-inner')
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/algolia.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> {preloader.endLoading()})</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    loader: {
      source: {
        '[tex]/amsCd': '[tex]/amscd'
      }
    },
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        addClass: [200,() => {
          document.querySelectorAll('mjx-container:not([display=\'true\']').forEach( node => {
            const target = node.parentNode
            if (!target.classList.contains('has-jax')) {
              target.classList.add('mathjax-overflow')
            }
          })
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>function loadValine () {
  function initValine () {
    let initData = {
      el: '#vcomment',
      appId: 'kvdp8zac8n33pNjoPPrELp1b-MdYXbMMI',
      appKey: 't7PV1NwrBX5XxIJWIt4SBNak',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'en',
      recordIP: true,
      serverURLs: 'https://kvdp8zac.api.lncldglobal.com',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
    }

    if (true) { 
      initData.requiredFields= ('nick'.split(','))
    }
    
    if (false) {
      const otherData = false
      initData = Object.assign({}, initData, otherData)
    }
    
    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.querySelector('#vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config_change',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  if (typeof gtag === 'function') {
    gtag('config', '', {'page_path': window.location.pathname});
  }

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})


document.addEventListener('pjax:send', function () {
  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})</script><script>(function(){
  const bp = document.createElement('script');
  const curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  bp.dataset.pjax = ''
  const s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})()</script></div></body></html>