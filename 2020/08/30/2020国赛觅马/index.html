<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>2020国赛觅马wp | Ron&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="关于2020国赛初赛的觅马个人wp">
<meta property="og:type" content="article">
<meta property="og:title" content="2020国赛觅马wp">
<meta property="og:url" content="https://lucxer.tk/2020/08/30/2020%E5%9B%BD%E8%B5%9B%E8%A7%85%E9%A9%AC/index.html">
<meta property="og:site_name" content="Ron&#39;s Blog">
<meta property="og:description" content="关于2020国赛初赛的觅马个人wp">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/lfsr.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/FSR.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/73741824.png">
<meta property="article:published_time" content="2020-08-30T13:21:19.000Z">
<meta property="article:modified_time" content="2020-12-12T10:52:29.923Z">
<meta property="article:author" content="Ron">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Crypto">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/lfsr.png">
  
    <link rel="alternate" href="/atom.xml" title="Ron's Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Ron&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">淡泊明志, 宁静致远</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://lucxer.tk"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-2020国赛觅马" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/08/30/2020%E5%9B%BD%E8%B5%9B%E8%A7%85%E9%A9%AC/" class="article-date">
  <time class="dt-published" datetime="2020-08-30T13:21:19.000Z" itemprop="datePublished">2020-08-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CTF/">CTF</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      2020国赛觅马wp
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p>本篇是对《第十三届全国大学生信息安全竞赛创新实践能力赛（线上初赛）》参赛经历的一个整理。</p>
</blockquote>
<h2 id="bd"><a href="#bd" class="headerlink" title="bd"></a>bd</h2><p>题目描述如此：</p>
<blockquote>
<p>数学在密码学里面很重要的！现在知道吃亏了吧！</p>
</blockquote>
<p>显然，他说的是大实话，确实应该好好学习数学。</p>
<p>下载附件，可以看到里面是一个py文件，文件内容如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">N = p * q</span><br><span class="line">phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    d = getRandomNBitInteger(<span class="number">200</span>)</span><br><span class="line">    <span class="keyword">if</span> GCD(d, phi) == <span class="number">1</span>:</span><br><span class="line">        e = inverse(d, phi)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, N)</span><br><span class="line"></span><br><span class="line">print(c, e, N, sep=<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 37625098109081701774571613785279343908814425141123915351527903477451570893536663171806089364574293449414561630485312247061686191366669404389142347972565020570877175992098033759403318443705791866939363061966538210758611679849037990315161035649389943256526167843576617469134413191950908582922902210791377220066</span></span><br><span class="line"><span class="comment"># 46867417013414476511855705167486515292101865210840925173161828985833867821644239088991107524584028941183216735115986313719966458608881689802377181633111389920813814350964315420422257050287517851213109465823444767895817372377616723406116946259672358254060231210263961445286931270444042869857616609048537240249</span></span><br><span class="line"><span class="comment"># 86966590627372918010571457840724456774194080910694231109811773050866217415975647358784246153710824794652840306389428729923771431340699346354646708396564203957270393882105042714920060055401541794748437242707186192941546185666953574082803056612193004258064074902605834799171191314001030749992715155125694272289</span></span><br></pre></td></tr></table></figure>


<p>打开映入眼帘的就是pq等字样，毫无疑问，多半是一个RSA了。</p>
<p>然后，再对代码逐行看过之后，看到11行，<strong>生成的d是比较小的</strong>，同时可以看到21行打印的<strong>e是比较大的</strong>（和n相比）。</p>
<p>因此，这个是一个妥妥的 <code>RSA小解密指数攻击</code> 的题目。（常规题型，不了解请Google一下）</p>
<p>于是，贴上解密代码，一瞬得到flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> myrsa <span class="keyword">import</span> hack_d, decrypt</span><br><span class="line"></span><br><span class="line">n = <span class="number">86966590627372918010571457840724456774194080910694231109811773050866217415975647358784246153710824794652840306389428729923771431340699346354646708396564203957270393882105042714920060055401541794748437242707186192941546185666953574082803056612193004258064074902605834799171191314001030749992715155125694272289</span></span><br><span class="line">e = <span class="number">46867417013414476511855705167486515292101865210840925173161828985833867821644239088991107524584028941183216735115986313719966458608881689802377181633111389920813814350964315420422257050287517851213109465823444767895817372377616723406116946259672358254060231210263961445286931270444042869857616609048537240249</span></span><br><span class="line">c = <span class="number">37625098109081701774571613785279343908814425141123915351527903477451570893536663171806089364574293449414561630485312247061686191366669404389142347972565020570877175992098033759403318443705791866939363061966538210758611679849037990315161035649389943256526167843576617469134413191950908582922902210791377220066</span></span><br><span class="line"></span><br><span class="line">d = hack_d(e, n)</span><br><span class="line"></span><br><span class="line">flag = decrypt(c, d, n)[<span class="number">0</span>]</span><br><span class="line">print(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;d3752538-90d0-c373-cfef-9247d3e16848&#125;</span></span><br></pre></td></tr></table></figure>


<h2 id="lfsr"><a href="#lfsr" class="headerlink" title="lfsr"></a>lfsr</h2><p>题目描述如下：</p>
<blockquote>
<p>弱鸡看着题目给的信息束手无策，丈二和尚摸不着头脑 ，你嘿嘿一笑，拿出来了你随身带着的笔记本电脑，噼里啪啦的敲起来了键盘，清晰的函数逻辑和流程出现在了电脑屏幕上，你敲敲键盘，答案变出现在了电脑屏幕上。</p>
</blockquote>
<p>读完题目描述，觉得这段话索然无味。。。。。。</p>
<p>还是依旧下载文件，里面是两个文件，一个是加密的程序，另一个是程序的输出。</p>
<p>加密程序 <code>lfsr.py</code> 如下：（注释都是我打的，原文是没有的）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">N = <span class="number">100</span></span><br><span class="line">MASK = <span class="number">2</span>**(N+<span class="number">1</span>) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lfsr</span>(<span class="params">state, mask</span>):</span></span><br><span class="line">    feedback = state &amp; mask</span><br><span class="line">    feed_bit = <span class="built_in">bin</span>(feedback)[<span class="number">2</span>:].count(<span class="string">&quot;1&quot;</span>) &amp; <span class="number">1</span>  <span class="comment"># feed_bit feedback中二进制位中1的个数是奇数个就是1</span></span><br><span class="line">    output_bit = state &amp; <span class="number">1</span> <span class="comment"># 输出位就是 state的奇偶 所以初始的state就是偶数  所以output里面前某位（最多100位）联合起来就是初始state</span></span><br><span class="line">    state = (state &gt;&gt; <span class="number">1</span>) | (feed_bit &lt;&lt; (N-<span class="number">1</span>)) <span class="comment"># 就是把feed_bit填入最高位</span></span><br><span class="line">    <span class="keyword">return</span> state, output_bit</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">assert</span> flag.startswith(<span class="string">&quot;flag&#123;&quot;</span>)</span><br><span class="line">    <span class="keyword">assert</span> flag.endswith(<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    mask = <span class="built_in">int</span>(flag[<span class="number">5</span>:-<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">assert</span> mask.bit_length() == N</span><br><span class="line">    </span><br><span class="line">    state  = random.randint(<span class="number">0</span>, MASK) <span class="comment"># 最多100位</span></span><br><span class="line">    print(state)</span><br><span class="line">    </span><br><span class="line">    outputs = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(N**<span class="number">2</span>):</span><br><span class="line">        state, output_bit = lfsr(state, mask)</span><br><span class="line">        outputs += <span class="built_in">str</span>(output_bit)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(outputs)</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<p>输出文件 <code>output.txt</code> 如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0100110011101111011111011010100111001010010100001111110110111101011110011111010010010111011100110111011001100001010010011101101000110110000011111011110000010100001001000011001011011011011001111110101111001010011011100010011110101100100101111001011100011110111101001010000000100100000111100101100100100000100110001111110011100110101000110100011001110110000110111111010111000001101110011001101111010110101000101011110111001011001111111000100100100011100100010101001100111011101111100110101011101101001001110010111011010011111001100001111111100001000001101101000001010100110011001101000101001010001001011000010111111100101111000000101000010110100110101001001100100011000111101000110011110101101111100110101010101000000001110010101001001111101001010111011110110001100101001111110111000110101011011010110101100011110010000011000110010111101010010000011101110111100011011110110001111010101011101100101101001111100100011000100101111011110001111100000110111000111111000111100000110011011011111110011111100010010110000010011100001010101011011101100011001100101100011001010010001101010011000000011110110111000000110001010010111110101011100000010100100001101011010101100110000101100010001010010111011000100001000001001110101011000010111000000010101100001010000010110110000111100011011000010111001111101110111010110000011001011101100000100000100010100100000010011010000111110010001111010000100011110000101111000110100010110101110001011101101100111000001110100100000000010011001110101110000001101100000001010111010011111000101101011001010011001101000111000010111111010101000011011001001110000011100100100010110101100001110110111001000001011111100101100011010010010110000011110100110000111011011010101110101001100110100101100101000100011001011000001011110010000011000110111011110011010001101100010010111110101101101110100111010000001101000011011010011110111101000000100011000000101001000000011010101010000100001110110000110011000111101011100100101111101111111110101000011010001101100010010100111000000010000101100100110101000001001011100011111001101001101100010100000111010101111011101111111101100000010000111110011101010100101110100101010100011110100100000111010001000100011010011100010011000001110110100110110010100100110111011001010010010100000110101110000011110010110100010101000110000111101011011010111101100111100101001101001101100111101000100101101100010111010010111100100111101101110101110011010110011111011111010000011000100010010101110001001000111111100100010100000001001010111010100010111001011011101110010110111110110100011111101110111011000111001010010110001001011011100110101111100100000101110000001011110011101110101101001011111100011001100111001011011001011011101000101100100011101000011101011010110010111111010011110111111111100001101101001101101111000100110010010100000100000100110100100110010000100101100000101010101000111110101001111111011011111101101110010100110000010110111001101110011101100001111111001110110010010011101111100111111000010011010010011100000001010011111111110001111110110110110001001001111011001101110110101100011010001111110010001011010000011110101100110010010001110010100010000000010101010010111011010101011011000010010011010110101101011100100101110001100000111110010101100010100010100010000101111000011111000111000011110001110110000011000100110010101111111111100011010000010010010111111110000000010100100101101101010111011000001010000000101011010110011101000110011011001110101101001001101100010011110001101001001000011001101100001101100000101111000001110100001100001000100000000011010011001001011110011000011011000100011011001011100111111000011011010000100000011110110011011110111000001011101101110110101000101011111110000100000111111110011111111100010101001000011010001110111111011100010111001110110001000101010001001001111111110111001101001001000110000110100000000010010100001010111101001110001011101011000100000001001001011111000100011111000011010001110001111111110111100010001110101011101011100010100000011110000100011001100000100111000111011011101000110010011010011110010010000111010001011111111010110011100111011110100111000101100100111001001010001000100011110101100100010000000000110010111101101111101011001101111000000000100000101001011110000010011110011000000100111001001110001000010011111010100001001010010100111111010111001001110110101010010100010010100101100000001010010111101101000110100111110000000111110000011110011001101010111101010111010111010000000110010001011110101110110001000110111101110101101001001100001101110001000100000110100000100000111110010110110010011111100010011111001110111011010101010001011111110000000011110001010011001101010110010101100101100110010111001100100111101000100010100010010100000010010111101100111110101101111101001010110010001111111001101010111110101111001000111101001110100000111111010000111000010101001001101100111001111111111100011010111110001101000100001010000000001101101001110001000001110010000010110001001001101010111111001001010100011011111011000011001001101000110010101000010100001001000011111001101101111011111001000010010111011010110010011010101100100000101100110110011011110000110011000000001011000111100101000011011011010010111000110101110101111100100010101010101000011000111000010001001000100110101111001001001111100110000101100010011101100001000010100010101110001111110101100101000101110000110010100101100101100101100100111111010100101010011100110100011111001000100010001101111111101011110100111001110101001101000010001011000111101110001010100101101111000110101001011101110110110110110101011010001110011111011110011010100110100111111010101111101111100110000110010111110110100110000011110110111111101111010011010000101010111100001111110110000001000001000011101001010010100100100000001101011101110011001011011110010111101111101010011010000110110101000100010110110101101010110110010011010011111111100001001000110111101001111000011001000010111100110001110110011011011100101011010101100011001111111000100000011100110011001001011000100010110000100001100011010000110110011100000111000010001011010001110010101000100010001001110001011001010000111010010101110001010100011101101110010111100010110010000011010111001101000100111011010100001010011100000100001010100010110100111000000001111100000100011100101011011101111111101101110011111010000110111101000001001110111000001000101100110100100111100100011011100010011111101010001101010100101110000110011000100001111100100001000000100011101101011011111000011110010110110101010011101000001111001011100101001001101111000011110000001010011010001110000111001101100011110011001100000111101001011000110111011001101101101100101100110100101011111111110110000111101000000100101011100111001111111011010100110010001000001101010001110010010000101111000001010100000101100000010101110100000000110011001011000011101101000000100111111010111110100011111101100001001110001100101100001010000100000110111101001101010000011100000000100000101101010010101111101100110110111000011100111001010010100101000111011001001110011111100010010010110100111101100110110111001011110010000111011111010101000010001101110011111010110011100010001111111011100110100011110110001101001110001010001110011110101111101011101100000111011011101110000110111101010001000011110011011101100011100101110100000100010110110011010101011000010010110000000100010011001110010011110010110111001111011010101111011000000111110000011011100100010011110010110000001111110111000100111010100110010111100010000110101011110011010110011001011011010010111001000000000001001010101010001100000110111101000000010100100010100101011111110011011100111101001110101010001100000100100110111110001111000011100010110001101101010011001011111101011000110110000111111101100000000001000010010010011101001000111100000010111011011001001100110000101010110001011000001011010111000111100111011010101010011100100100100010000001101001101010111110010100101000001100111110111111110000101111100110001110111010111001111110111100000111011011010111011001111010100010000111011111111000100110110001100000110101000001010010010100111011100000011111110001000010011010101001111010111100011110110110111000000111101010110001100000100001101101001101010111110001101101100101101101001000100000100110111111010011010011111010110110111101001000100010111101100011010111011111010011110000100001100101101111110010101000000101111101000001111110100000001011011111111100100110101101011100101101001011010001100010101101100000101000001110110101010100001011100010000111010011101110000000010000000000010111100111000010000000110110011011101110000001111011100011101111100011000011001000100111010101011010101110011010011011011010100011011000110111101001110011110000100010011000010000001101010010011000111000000000101100011010001000100010100100100011000101110100010001111101001010100001000000110010011101011101000000100010000011010110100111110101110001111001000000101011101010111110110100100011010000011010111111001001111101101110111110111000001010111100010001001001100000000110011100001100100111010011111011001010001101111111000010110101000011100001010110100101110111001001100000000110110101011001110000011001111100001101110100101101111100110001010011011001010110111000100010000110001111101110011100001101000100110000111000110001011011110100010101011011001001111101001110011100001110001010100011001110110101101001101010101001110011110001011101011100100001101100110110110101011101010110011100000001011010111011101000000101110111110010000000000101001110011111011001110001100010111001010010110011100001000011111101111101100111000101011100011000001100000000000010000111111010010101110101011100010100001000000100111111010111110010010111010110010100111000010111100000000100010111010010011010011001100010001000001100110100101110100110110111101010001100001010011111011100000010110110110000000100101100110100101100111001010100010001011010001010011110100110101000110001110000100111111001000110011110010111000110010001111111111101011110100111101001001101110110011111000110010111000011011111001110101101101000011010101011010111101011101111011100101001111111000101100100000011000100101001011001011110001101001100101001</span><br></pre></td></tr></table></figure>
<p>下载之后，一开始我一脸懵逼，不知道这是在考什么。</p>
<p>于是我就Google了一下 “lfsr”，结果Google给了我这个↓</p>
<p><img src="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/lfsr.png" alt="lfsr"></p>
<p>哎呀！我这个觅马菜鸡，觅马学都没学好，居然对学过的LFSR都不敏感了。 <strong>Linear（线性） Feedback（反馈） Shift（移位） Register（寄存器）</strong> 看看多好记的。</p>
<blockquote>
<p>不知道的同学可以随便先去了解下</p>
</blockquote>
<p>简单说说（意思就是我个人的理解，不代表真实定义）这个<strong>反馈移位寄存器，FSR</strong>就是下面这个图的样子👇，</p>
<p><img src="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/FSR.png" alt="FSR"></p>
<blockquote>
<p>有一个框框有固定长度n，每一个小格子中的数<strong>要么是0，要么是1</strong>，我们就可以称其为<strong>寄存器</strong>，代码中可以用数组来模拟。</p>
<p>这个框框每次都从右边输出固定m位的ai，然后就会往右移动m位，再利用<strong>某种算法</strong>计算出m个数，依次填在左边的m位，这样是不是就是相当于移动起来了？于是就可以称其位<strong>移位寄存器</strong>。一般情况下，都是输出一位，移动一位，计算出新的一位，即m=1，下面都以m=1来谈。</p>
<p>上面提到的某种算法，在这里我们就称之为，<strong>“反馈函数”</strong>，表达式为 a<sub>n+1</sub> = f(a<sub>n</sub>, a<sub>n-1</sub>,,,,,a<sub>1</sub>)  这样通过前面的n个状态，我们就可以推算出下一个状态。</p>
<p>当这里的反馈函数为线性函数时，我们就称其为 <strong>“线性反馈移位寄存器”</strong>，那么在GF(2)上（不知道的同学可以简单理解为取值只有0和1），线性函数的即是寄存器中的某些位的异或。<del>（不要问我怎么知道的，想想那异或运算的性质，0和1的计算结果还是0和1，我们就可以简单地通过是仅仅选择某些位来进行异或）</del> 此时，反馈函数就是下面这样👇<br>$$<br>f(a_1,a_2,…,a_n) = c_1a_1 \oplus c_2a_2 \oplus … \oplus c_na_n<br>$$<br>其中c<sub>i</sub> 取值只能是0或者1，为0可以理解为没有选择这一位，为1可以理解为选择了这一位。</p>
</blockquote>
<p>那既然咱已经学过了，应该还是有可能做得出来哦。那代码肯定就是整了一个LFSR来构建流觅马咯。那就康康代码先。</p>
<p>果然，代码第8~13行定义了一个 <code>lfsr</code> 函数了作为LFSR。我们暂且跳过它，看 <code>main</code> 函数。</p>
<p>16<del>17行就是告诉我们，flag 是 <code>flag&#123;***************&#125;</code> 这个样子的。 20行就是告诉我们中间需要我们求的部分是100位的（<strong>二进制位哈</strong>）。然后它把我们要的 flag 变成了它的 <code>mask</code> 了，<strong>所以我们就是要整出来这个玩意，就是我们要的 flag 了</strong>。22行，接着它随机了一个 <code>state</code>，也是最多100位的。26</del>32行它把 LFSR 的前10000个输出结果告诉我们了。 </p>
<p>接下来就是分析 <code>lfsr</code> ：</p>
<p>第9行，其将输入的 <code>state</code> 和 <code>mask</code> 进行了一个<strong>与操作</strong>，并赋值给了 <code>feedback</code>，暂且不懂其意义，但是多半是反馈函数的一部分，毕竟feedback的英文意思在这里，搁置先。</p>
<p>第10行，将上面与运算后的结果 <code>feedback</code> 转化为了2进制，然后切片去掉了前面的’0b’字段， <code>.count(&quot;1&quot;)</code> 是个什么玩意？？不过顾名思义，应该或许大概就是统计1的个数。关于这一点，可以自己写一个py很好进行验证。结果证明就是这样。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="built_in">bin</span>(<span class="number">5</span>)[<span class="number">2</span>:].count(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">print(s)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5 = 101</span></span><br><span class="line"><span class="comment"># s = 2</span></span><br></pre></td></tr></table></figure>
<p>然后又与了一个1，那就是第10行是在判断，<code>state</code> 和 <code>mask</code> 中一样都是1的位数是奇数位还是偶数位。</p>
<p>第11行，就是将当前的 <code>state</code> 的最后一位赋值给 <code>output_bit</code> </p>
<p>第12行，就是将 <code>state</code> 右移1位再和 <code>feed_bit</code> 左移 N-1位相或。并更新 <code>state</code> 。那到这里，也即是说 <code>state</code> 就是我们前面所说的 <strong>那个框框</strong>。而12行就是将原来的 <code>state</code>  右移1位，<code>feed_bit</code> 填在了最高位，也就是说，<code>feed_bit</code> 就是反馈函数的输出。</p>
<p>第13行，就将新寄存器和旧寄存器的最后一位返回出去了。而后者就是在我们的output文件中。</p>
<p>再回到前面可以看到，9行和10行，就是我们的反馈函数。</p>
<p>那么，如果我们知道寄存器的位数，其实我们是可以知道寄存器的初始状态的，即最前面随机生成的 <code>state</code> 。也就是output的前多少位。</p>
<p>现在，才到了问题最关键的地方，怎么把9行和10行，转化为我们前面的公式（1） 的样儿呢？</p>
<p><strong>思考思考思考……</strong></p>
<p>好的，我思考出来了。</p>
<p>为了方便，我们把公式（1）给贴一份到这里。<br>$$<br>f(a_1,a_2,…,a_n) = c_1a_1 \oplus c_2a_2 \oplus … \oplus c_na_n<br>$$<br>然后考虑第9行和第10行代码，为了方便，也贴这里。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">feedback = state &amp; mask</span><br><span class="line">feed_bit = <span class="built_in">bin</span>(feedback)[<span class="number">2</span>:].count(<span class="string">&quot;1&quot;</span>) &amp; <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>因为是在按位进行与，所以我们可以把他们看做一个等长的bool数组。于是可以将第9行转化为👇这个。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">feedback[i] = state[i] &amp; mask[i] </span><br><span class="line"><span class="comment"># i from 0 to length</span></span><br></pre></td></tr></table></figure>
<p>那原代码的第10行，不就是在看这些所有的 <code>feedback[i]</code> 中1的个数是奇数还是偶数嘛？</p>
<p>那一堆01的串，你要统计他的个数是奇数还是偶数，除了一个个数，还能怎么计算呢？</p>
<p>那你试试，把他们这一堆01的串，逐位进行异或会怎么样呢？</p>
<p><strong>好吧，事实就是这样，你把一堆01串逐位异或起来得到的结果，和你直接去数1的个数是奇数还是偶数，再与上1进行判断，结果是一样的。</strong>如公式（3）所示：<br>$$<br>feed_bit == (\sum\limits_{k=1}^na_k) &amp; 1 == a_1\oplus a_2 \ \oplus … \oplus\ a_n \ ,\ \forall\ a_k \in {0\ ,\ 1}<br>$$<br>那既然这样了，岂不是就已经可以得到 反馈函数了？如果把公式（3）中的 a<sub>k</sub> 视作 <code>feedback[k]</code> 是不是就ok了？</p>
<blockquote>
<p>原来的代码的第10行，不正是公式（3）中的左半部分吗？统计1的个数和把他们直接加起来是一样的效果吧？毕竟取值只有0和1</p>
</blockquote>
<p>于是，我们可以把原来第10行，直接相当于公式（3）中的右半部分，对吧？那么和我们想要的反馈函数，公式（1）相比，差了什么呢？是不是就是 a<sub>k</sub> 前面的系数 c<sub>k</sub> ?</p>
<p>那其实我们知道 <code>feedback</code> 只是一个中间变量，我们其实是不需要它的，<strong>我们事实上是关心的 <code>state</code> 毕竟他才是寄存器。</strong> 而反馈函数中的每一个 a<sub>k</sub> 其实都是寄存器中的一个元素。因此，刚才我们将 <code>feedback[k]</code> 这个中间变量视作了 a<sub>k</sub> ，现在我们要给他还回去，变成 <code>state[k]</code> ，而原代码的第9行，不就是 <code>state</code> 和 <code>feedback</code> 的关系吗？而且刚好是 <strong>与关系</strong> 。看到这里明白了吧？ <code>state[k]</code> 才是我们的 a<sub>k</sub> 而 <code>mask[k]</code> 则刚好构成我们的 c<sub>k</sub>。</p>
<blockquote>
<p>如果还是很迷，不妨回到刚才， a<sub>k</sub> 视作 <code>feedback[k]</code> 。 那么 <code>feedback[k]</code> = <code>state[k]</code> &amp; <code>mask[k]</code> 没毛病吧？然后在换元，把a<sub>k</sub> 替换成 <code>state[k]</code> &amp; <code>mask[k]</code> 为了书写方便，我们可以将 <code>state[k]</code>  记为 b<sub>k</sub> 将 <code>mask[k]</code> 记为 c<sub>k</sub> 。于是公式（3）就是公式（4）</p>
</blockquote>
<p>$$<br>feed_bit == a_1\oplus a_2 \ \oplus … \oplus\ a_n \  == c_1b_1 \oplus c_2b_2 \oplus … \oplus c_nb_n<br>$$</p>
<p>可以看到，此时，公式（4）的最左侧和最右侧。 b<sub>k</sub> 是 <code>state</code> (寄存器)此时的状态，而 c<sub>k</sub> 是 <code>mask</code> ，而 <code>feed_bit</code> 是寄存器的反馈状态，也就是下一位，用这里的统一符号就是 <code>feed_bit</code> 就是 b<sub>N+1</sub> (N 是寄存器的位数)。<strong>为了表示习惯的统一，我们还是将b换为a统一表示</strong>，就有了下面的公式（5的 <strong>反馈函数</strong>：<br>$$<br>a_{n+1} = c_1a_1 \oplus c_2a_2 \oplus … \oplus c_na_n<br>$$<br><strong>那么现在，问题就很清楚了，我们要找的 flag 就是mask，而mask就是我们反馈函数中的系数 c<sub>k</sub>，我们把这个玩意求出来了，flag就到手了。</strong></p>
<p>偶滴个乖乖讲了半天，还是不知道这个c<sub>k</sub> 咋求哒。莫方莫方。接下来就快了。</p>
<p>根据公式（5）我们能得到什么？ 能得到公式（6）。<br>$$<br>a_{n+1} = c_1a_1 \oplus c_2a_2 \oplus … \oplus c_na_n \ a_{n+2} = c_1a_2 \oplus c_2a_3 \oplus … \oplus c_na_{n+1} \ a_{n+3} = c_1a_3 \oplus c_2a_4 \oplus … \oplus c_na_{n+2} \ \vdots \a_{n+n} = c_1a_n \oplus c_2a_{n+1} \oplus … \oplus c_na_{n+(n-1)} \<br>$$<br>公式（6）太过于冗余不好看，我们给它换一个写法。写作如下的矩阵形式。<br>$$<br>\begin{pmatrix}<br>a_{n + 1} \<br>a_{n + 2} \<br>\vdots \<br>a_{n + n} \<br>\end{pmatrix}</p>
<p>=</p>
<p>\begin{pmatrix}<br>a_1 \quad a_2      &amp; \cdots &amp; \quad a_n \<br>a_2 \quad a_3      &amp; \cdots &amp; a_{n+1}  \<br>\vdots \quad \vdots &amp; \ddots &amp; \vdots \<br>a_n \quad a_{n+1}      &amp; \cdots &amp; a_{n+n}<br>\end{pmatrix}</p>
<p>\times</p>
<p>\begin{pmatrix}<br>c_1 \<br>c_2 \<br>\vdots \<br>c_n \<br>\end{pmatrix}</p>
<p>=</p>
<p>A</p>
<p>\begin{pmatrix}<br>c_1 \<br>c_2 \<br>\vdots \<br>c_n \<br>\end{pmatrix}<br>$$<br>那么，根据公式（7），显然，如果我们能得到 2n个 a<sub>k</sub> ，我们就能构造出上述的A矩阵和左边的列向量。同时，如果A是可逆的。我们可以直接左乘一个 A<sup>-1</sup> 就可得到系数的向量了。<br>$$<br>\begin{pmatrix}<br>c_1 \<br>c_2 \<br>\vdots \<br>c_n \<br>\end{pmatrix}</p>
<p>=<br>A^{-1}</p>
<p>\begin{pmatrix}<br>a_{n + 1} \<br>a_{n + 2} \<br>\vdots \<br>a_{n + n} \<br>\end{pmatrix}<br>$$<br>于是这个题就迎刃而解了。题目中给了n<sup>2</sup> 位输出，所以我们直接枚举就好。虽然不知道n是多少，但是可以枚举n从2~100。然后求出mask，即flag。</p>
<blockquote>
<p>这里有个小投机，虽然不知道n的大小，但是我们知道flag是100位的，所以只把100位的flag打出来就好了</p>
</blockquote>
<p>下面就直接贴代码了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">output = <span class="string">&#x27;0100110011101111011111011010100111001010010100001111110110111101011110011111010010010111011100110111011001100001010010011101101000110110000011111011110000010100001001000011001011011011011001111110101111001010011011100010011110101100100101111001011100011110111101001010000000100100000111100101100100100000100110001111110011100110101000110100011001110110000110111111010111000001101110011001101111010110101000101011110111001011001111111000100100100011100100010101001100111011101111100110101011101101001001110010111011010011111001100001111111100001000001101101000001010100110011001101000101001010001001011000010111111100101111000000101000010110100110101001001100100011000111101000110011110101101111100110101010101000000001110010101001001111101001010111011110110001100101001111110111000110101011011010110101100011110010000011000110010111101010010000011101110111100011011110110001111010101011101100101101001111100100011000100101111011110001111100000110111000111111000111100000110011011011111110011111100010010110000010011100001010101011011101100011001100101100011001010010001101010011000000011110110111000000110001010010111110101011100000010100100001101011010101100110000101100010001010010111011000100001000001001110101011000010111000000010101100001010000010110110000111100011011000010111001111101110111010110000011001011101100000100000100010100100000010011010000111110010001111010000100011110000101111000110100010110101110001011101101100111000001110100100000000010011001110101110000001101100000001010111010011111000101101011001010011001101000111000010111111010101000011011001001110000011100100100010110101100001110110111001000001011111100101100011010010010110000011110100110000111011011010101110101001100110100101100101000100011001011000001011110010000011000110111011110011010001101100010010111110101101101110100111010000001101000011011010011110111101000000100011000000101001000000011010101010000100001110110000110011000111101011100100101111101111111110101000011010001101100010010100111000000010000101100100110101000001001011100011111001101001101100010100000111010101111011101111111101100000010000111110011101010100101110100101010100011110100100000111010001000100011010011100010011000001110110100110110010100100110111011001010010010100000110101110000011110010110100010101000110000111101011011010111101100111100101001101001101100111101000100101101100010111010010111100100111101101110101110011010110011111011111010000011000100010010101110001001000111111100100010100000001001010111010100010111001011011101110010110111110110100011111101110111011000111001010010110001001011011100110101111100100000101110000001011110011101110101101001011111100011001100111001011011001011011101000101100100011101000011101011010110010111111010011110111111111100001101101001101101111000100110010010100000100000100110100100110010000100101100000101010101000111110101001111111011011111101101110010100110000010110111001101110011101100001111111001110110010010011101111100111111000010011010010011100000001010011111111110001111110110110110001001001111011001101110110101100011010001111110010001011010000011110101100110010010001110010100010000000010101010010111011010101011011000010010011010110101101011100100101110001100000111110010101100010100010100010000101111000011111000111000011110001110110000011000100110010101111111111100011010000010010010111111110000000010100100101101101010111011000001010000000101011010110011101000110011011001110101101001001101100010011110001101001001000011001101100001101100000101111000001110100001100001000100000000011010011001001011110011000011011000100011011001011100111111000011011010000100000011110110011011110111000001011101101110110101000101011111110000100000111111110011111111100010101001000011010001110111111011100010111001110110001000101010001001001111111110111001101001001000110000110100000000010010100001010111101001110001011101011000100000001001001011111000100011111000011010001110001111111110111100010001110101011101011100010100000011110000100011001100000100111000111011011101000110010011010011110010010000111010001011111111010110011100111011110100111000101100100111001001010001000100011110101100100010000000000110010111101101111101011001101111000000000100000101001011110000010011110011000000100111001001110001000010011111010100001001010010100111111010111001001110110101010010100010010100101100000001010010111101101000110100111110000000111110000011110011001101010111101010111010111010000000110010001011110101110110001000110111101110101101001001100001101110001000100000110100000100000111110010110110010011111100010011111001110111011010101010001011111110000000011110001010011001101010110010101100101100110010111001100100111101000100010100010010100000010010111101100111110101101111101001010110010001111111001101010111110101111001000111101001110100000111111010000111000010101001001101100111001111111111100011010111110001101000100001010000000001101101001110001000001110010000010110001001001101010111111001001010100011011111011000011001001101000110010101000010100001001000011111001101101111011111001000010010111011010110010011010101100100000101100110110011011110000110011000000001011000111100101000011011011010010111000110101110101111100100010101010101000011000111000010001001000100110101111001001001111100110000101100010011101100001000010100010101110001111110101100101000101110000110010100101100101100101100100111111010100101010011100110100011111001000100010001101111111101011110100111001110101001101000010001011000111101110001010100101101111000110101001011101110110110110110101011010001110011111011110011010100110100111111010101111101111100110000110010111110110100110000011110110111111101111010011010000101010111100001111110110000001000001000011101001010010100100100000001101011101110011001011011110010111101111101010011010000110110101000100010110110101101010110110010011010011111111100001001000110111101001111000011001000010111100110001110110011011011100101011010101100011001111111000100000011100110011001001011000100010110000100001100011010000110110011100000111000010001011010001110010101000100010001001110001011001010000111010010101110001010100011101101110010111100010110010000011010111001101000100111011010100001010011100000100001010100010110100111000000001111100000100011100101011011101111111101101110011111010000110111101000001001110111000001000101100110100100111100100011011100010011111101010001101010100101110000110011000100001111100100001000000100011101101011011111000011110010110110101010011101000001111001011100101001001101111000011110000001010011010001110000111001101100011110011001100000111101001011000110111011001101101101100101100110100101011111111110110000111101000000100101011100111001111111011010100110010001000001101010001110010010000101111000001010100000101100000010101110100000000110011001011000011101101000000100111111010111110100011111101100001001110001100101100001010000100000110111101001101010000011100000000100000101101010010101111101100110110111000011100111001010010100101000111011001001110011111100010010010110100111101100110110111001011110010000111011111010101000010001101110011111010110011100010001111111011100110100011110110001101001110001010001110011110101111101011101100000111011011101110000110111101010001000011110011011101100011100101110100000100010110110011010101011000010010110000000100010011001110010011110010110111001111011010101111011000000111110000011011100100010011110010110000001111110111000100111010100110010111100010000110101011110011010110011001011011010010111001000000000001001010101010001100000110111101000000010100100010100101011111110011011100111101001110101010001100000100100110111110001111000011100010110001101101010011001011111101011000110110000111111101100000000001000010010010011101001000111100000010111011011001001100110000101010110001011000001011010111000111100111011010101010011100100100100010000001101001101010111110010100101000001100111110111111110000101111100110001110111010111001111110111100000111011011010111011001111010100010000111011111111000100110110001100000110101000001010010010100111011100000011111110001000010011010101001111010111100011110110110111000000111101010110001100000100001101101001101010111110001101101100101101101001000100000100110111111010011010011111010110110111101001000100010111101100011010111011111010011110000100001100101101111110010101000000101111101000001111110100000001011011111111100100110101101011100101101001011010001100010101101100000101000001110110101010100001011100010000111010011101110000000010000000000010111100111000010000000110110011011101110000001111011100011101111100011000011001000100111010101011010101110011010011011011010100011011000110111101001110011110000100010011000010000001101010010011000111000000000101100011010001000100010100100100011000101110100010001111101001010100001000000110010011101011101000000100010000011010110100111110101110001111001000000101011101010111110110100100011010000011010111111001001111101101110111110111000001010111100010001001001100000000110011100001100100111010011111011001010001101111111000010110101000011100001010110100101110111001001100000000110110101011001110000011001111100001101110100101101111100110001010011011001010110111000100010000110001111101110011100001101000100110000111000110001011011110100010101011011001001111101001110011100001110001010100011001110110101101001101010101001110011110001011101011100100001101100110110110101011101010110011100000001011010111011101000000101110111110010000000000101001110011111011001110001100010111001010010110011100001000011111101111101100111000101011100011000001100000000000010000111111010010101110101011100010100001000000100111111010111110010010111010110010100111000010111100000000100010111010010011010011001100010001000001100110100101110100110110111101010001100001010011111011100000010110110110000000100101100110100101100111001010100010001011010001010011110100110101000110001110000100111111001000110011110010111000110010001111111111101011110100111101001001101110110011111000110010111000011011111001110101101101000011010101011010111101011101111011100101001111111000101100100000011000100101001011001011110001101001100101001&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">work</span>(<span class="params">n, key</span>):</span></span><br><span class="line">    array_1 = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            array_1.append(<span class="built_in">int</span>(key[i + j]))</span><br><span class="line">    A = matrix(GF(<span class="number">2</span>), n, n, array_1)</span><br><span class="line">    array_2 = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        array_2.append(<span class="built_in">int</span>(key[i + n]))</span><br><span class="line">    B = matrix(GF(<span class="number">2</span>), n, <span class="number">1</span>, array_2)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        c = A.solve_right(B)</span><br><span class="line">        <span class="keyword">return</span> c</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">100</span>):</span><br><span class="line">    c = work(n = n, key = output)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(c) == <span class="number">100</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">tmp = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> c[::-<span class="number">1</span>]:</span><br><span class="line">	tmp += <span class="built_in">str</span>(x[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;flag&#123;&#x27;</span> + <span class="built_in">str</span>(<span class="built_in">int</span>(tmp, <span class="number">2</span>)) + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment"># flag&#123;856137228707110492246853478448&#125;</span></span><br></pre></td></tr></table></figure>


<h2 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h2><p>题目描述如下：</p>
<blockquote>
<p>小明经过研究，发现RSA加密算法可以推广，也就是它的模不仅仅是只能为两个素数的乘积，只要是2个以上不同的素数相乘都可以。</p>
</blockquote>
<p>根据题目和描述，这个题是一个多质数的RSA<strong>（multi-prime RSA）</strong> </p>
<p>给出的文件 <code>cipher.txt</code> 很简单，就只有n,e,c</p>
<blockquote>
<p>n = 50142032499469550407421604706771611415193641755639270667473328045908799316205905505167271138079522738272643811917325451177986948493659090203974349370248583120022500722759239305447823602875823849366662503027591858371125301505134216095903796534740686834236150999<br>e = 65537<br>c = 45005399504992587510006608300548120810512973768886391125598523343330913326304417790989607300367232977960116381108873363343598357102136548218343380795022179607741940866191404186680657699739176842869814452906110393321567314747096161480003824583613027819960172221</p>
</blockquote>
<p>显然，这个题我们只有分解n，因为e是安全的，同时没有额外的信息，能利用的仅仅就是n有多个因数。</p>
<p>那么，二话不说，暴力分解走起。</p>
<p>遗憾的是，在线查找和yafu分解都失败了。yafu跑了好久都没有出来。</p>
<p>于是，我又尝试，自己手动来，从小质数开始枚举，一直枚举到了第100000*70个质数，还是没有成功枚举到一个因子。</p>
<p>这说明，这个n是没有小质因数的。</p>
<p>同时他又有多个质因数。</p>
<p><strong>猜测1：</strong>因此他的各个质因数的差距应该不大。</p>
<p>然后，我开始Google，毕竟我坚信这个是一种我没见过的新题型。看了好多英文论文，但是感觉写得都很垃圾。<del>（我英文垃圾，时间又很紧迫）</del> 各个论文都证明了半天，但是我感觉没啥用。倒是<strong>Google的搜索结果中，针对这种multi-prime RSA的攻击基本上都是基于他的质因数差异比较小来进行的。</strong> 这更加坚定了我的<strong>猜测1</strong>。</p>
<p>于是，借鉴普通RSA问题中，p和q太接近时的费马分解法的思路</p>
<blockquote>
<p>由于n = p * q,当p和q的差距太小时，这意味着p和q都会在 n<sup>1/2</sup> 附件。由于差距较小，所以我们可以在这个差距范围内进行枚举，进而实现对n的分解。</p>
</blockquote>
<p>我局得这个多因数的也是可以用类似的手法进行攻击的。</p>
<p>于是我枚举根次，从3枚举到20，每个附件的差异我定义为10亿。</p>
<p>代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = gmpy2.mpz(<span class="number">50142032499469550407421604706771611415193641755639270667473328045908799316205905505167271138079522738272643811917325451177986948493659090203974349370248583120022500722759239305447823602875823849366662503027591858371125301505134216095903796534740686834236150999</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 猜测的差异范围</span></span><br><span class="line">tot = <span class="number">1000000000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, <span class="number">21</span>):</span><br><span class="line">    </span><br><span class="line">    p0 = gmpy2.iroot(n, num)[<span class="number">0</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(tot):</span><br><span class="line">        <span class="keyword">if</span> n % (p0 + i) == <span class="number">0</span>:</span><br><span class="line">            print(p0 + i)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> n % (p0 - i) == <span class="number">0</span>:</span><br><span class="line">            print(p0 - i)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>很可惜，我没有跑出来它的因数，于是我又扩大了范围从20~100.</p>
<p>终于跑完了之后，我还是没有得到解。</p>
<p>于是我又扎进了寻找论文和Google方法中，<strong>因为我坚信，这是一类有其他方法一瞬得到结果的</strong>。</p>
<p>很遗憾，我没有在规定时间内拿到flag</p>
<p>赛后，我从同学哪里得知，<strong>开3次方根，将范围改到 2<sup>30</sup> 次方就可以爆破出来</strong>。</p>
<p>于是，新的代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">n = gmpy2.mpz(<span class="number">50142032499469550407421604706771611415193641755639270667473328045908799316205905505167271138079522738272643811917325451177986948493659090203974349370248583120022500722759239305447823602875823849366662503027591858371125301505134216095903796534740686834236150999</span>)</span><br><span class="line"></span><br><span class="line">p0 = gmpy2.iroot(n, <span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">tot = <span class="number">1</span> &lt;&lt; <span class="number">30</span></span><br><span class="line"></span><br><span class="line">start = time()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(tot):</span><br><span class="line">	<span class="keyword">if</span> n % (p0 + i) == <span class="number">0</span>:</span><br><span class="line">		print(p0 + i)</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">if</span> n % (p0 - i) == <span class="number">0</span>:</span><br><span class="line">		print(p0 - i)</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">end = time()</span><br><span class="line"></span><br><span class="line">print(<span class="string">f&quot;用时：<span class="subst">&#123;end - start&#125;</span> s&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>我计了一个时，442秒，就成功爆破出了n的一个质因数，后面就简单了，直接yafu分解剩下的部分，然后就可以得到flag。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;4e9f2a7f-bda9-4a46-af51-b29e0c61973e&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/73741824.png" alt="73741824"></p>
<p><del><strong>我算了算，2<sup>30</sup> - 10<sup>9</sup> = 73741824</strong>，原来我离AK，甚至一血只差了73741824。</del></p>
<p><strong>谨以此，已备忘。</strong></p>
<h2 id="参考链接："><a href="#参考链接：" class="headerlink" title="参考链接："></a>参考链接：</h2><ul>
<li><a target="_blank" rel="noopener" href="https://nonuplebroken.com/2020/06/10/%E5%8F%8D%E9%A6%88%E7%A7%BB%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8/#%E5%8F%8D%E9%A6%88%E7%A7%BB%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8">https://nonuplebroken.com/2020/06/10/%E5%8F%8D%E9%A6%88%E7%A7%BB%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8/#%E5%8F%8D%E9%A6%88%E7%A7%BB%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://lucxer.tk/2020/08/30/2020%E5%9B%BD%E8%B5%9B%E8%A7%85%E9%A9%AC/" data-id="ckja3vkqj001u14lnb7tog2h8" data-title="2020国赛觅马wp" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Crypto/" rel="tag">Crypto</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/09/15/latex%E9%85%8D%E7%BD%AE/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">前一篇</strong>
      <div class="article-nav-title">
        
          Windows 下 latex 配置
        
      </div>
    </a>
  
  
    <a href="/2020/08/11/%E6%9D%82%E9%A1%B9/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">后一篇</strong>
      <div class="article-nav-title">杂项</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/">CTF</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E9%A1%B9/">杂项</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/">环境配置</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BB%83%E4%B9%A0/">练习</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CUDA/" rel="tag">CUDA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Crypto/" rel="tag">Crypto</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MiKTeX/" rel="tag">MiKTeX</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PWN/" rel="tag">PWN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Q-A/" rel="tag">Q&A</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL%E6%B3%A8%E5%85%A5/" rel="tag">SQL注入</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WSL/" rel="tag">WSL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WSL2/" rel="tag">WSL2</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/" rel="tag">Windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/XSS%E6%94%BB%E5%87%BB/" rel="tag">XSS攻击</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/" rel="tag">blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/face-recognition/" rel="tag">face recognition</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/" rel="tag">github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/latex/" rel="tag">latex</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/opencv/" rel="tag">opencv</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pycuda/" rel="tag">pycuda</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tips/" rel="tag">tips</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/" rel="tag">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wp/" rel="tag">wp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zeit/" rel="tag">zeit</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" rel="tag">人工智能</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/" rel="tag">人脸识别</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82%E9%A1%B9/" rel="tag">杂项</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%88%E6%BA%A2%E5%87%BA/" rel="tag">栈溢出</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" rel="tag">深度学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%85%8D%E7%BD%AE/" rel="tag">配置</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/CTF/" style="font-size: 16.67px;">CTF</a> <a href="/tags/CUDA/" style="font-size: 10px;">CUDA</a> <a href="/tags/Crypto/" style="font-size: 10px;">Crypto</a> <a href="/tags/Linux/" style="font-size: 13.33px;">Linux</a> <a href="/tags/MiKTeX/" style="font-size: 10px;">MiKTeX</a> <a href="/tags/PWN/" style="font-size: 10px;">PWN</a> <a href="/tags/Q-A/" style="font-size: 10px;">Q&A</a> <a href="/tags/SQL%E6%B3%A8%E5%85%A5/" style="font-size: 10px;">SQL注入</a> <a href="/tags/WSL/" style="font-size: 13.33px;">WSL</a> <a href="/tags/WSL2/" style="font-size: 10px;">WSL2</a> <a href="/tags/Windows/" style="font-size: 16.67px;">Windows</a> <a href="/tags/XSS%E6%94%BB%E5%87%BB/" style="font-size: 10px;">XSS攻击</a> <a href="/tags/blog/" style="font-size: 10px;">blog</a> <a href="/tags/face-recognition/" style="font-size: 10px;">face recognition</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/latex/" style="font-size: 10px;">latex</a> <a href="/tags/opencv/" style="font-size: 10px;">opencv</a> <a href="/tags/pycuda/" style="font-size: 10px;">pycuda</a> <a href="/tags/tips/" style="font-size: 10px;">tips</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a> <a href="/tags/wp/" style="font-size: 10px;">wp</a> <a href="/tags/zeit/" style="font-size: 10px;">zeit</a> <a href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" style="font-size: 10px;">人工智能</a> <a href="/tags/%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/" style="font-size: 10px;">人脸识别</a> <a href="/tags/%E6%9D%82%E9%A1%B9/" style="font-size: 10px;">杂项</a> <a href="/tags/%E6%A0%88%E6%BA%A2%E5%87%BA/" style="font-size: 10px;">栈溢出</a> <a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" style="font-size: 10px;">深度学习</a> <a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 13.33px;">笔记</a> <a href="/tags/%E9%85%8D%E7%BD%AE/" style="font-size: 20px;">配置</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/12/29/test/">test</a>
          </li>
        
          <li>
            <a href="/2020/12/29/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2020/12/29/WSL+CUDA/">Windows 下利用 WSL2 配置 CUDA和pyCUDA</a>
          </li>
        
          <li>
            <a href="/2020/12/28/WSL2%E5%AE%89%E8%A3%85/">Windows 使用 lxrunoffline 安装 WSL、WSL2</a>
          </li>
        
          <li>
            <a href="/2020/11/27/ubuntu_opencv_face_reconginition/">opcv + face_recognition 实现人脸实时识别</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2020 Ron<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>